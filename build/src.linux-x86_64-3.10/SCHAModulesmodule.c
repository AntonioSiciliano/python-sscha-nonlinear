/* File: SCHAModulesmodule.c
 * This file is auto-generated with f2py (version:1.23.3).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Mon Apr 17 15:07:36 2023
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */

/* Unconditionally included */
#include <Python.h>
#include <numpy/npy_os.h>

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include <stdarg.h>
#include "fortranobject.h"
#include <string.h>
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *SCHAModules_error;
static PyObject *SCHAModules_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
typedef char * string;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/
\
#define FAILNULL(p) do {                                            \
    if ((p) == NULL) {                                              \
        PyErr_SetString(PyExc_MemoryError, "NULL pointer found");   \
        goto capi_fail;                                             \
    }                                                               \
} while (0)

#define STRINGMALLOC(str,len)\
    if ((str = (string)malloc(len+1)) == NULL) {\
        PyErr_SetString(PyExc_MemoryError, "out of memory");\
        goto capi_fail;\
    } else {\
        (str)[len] = '\0';\
    }

#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif

#define rank(var) var ## _Rank
#define shape(var,dim) var ## _Dims[dim]
#define old_rank(var) (PyArray_NDIM((PyArrayObject *)(capi_ ## var ## _tmp)))
#define old_shape(var,dim) PyArray_DIM(((PyArrayObject *)(capi_ ## var ## _tmp)),dim)
#define fshape(var,dim) shape(var,rank(var)-dim-1)
#define len(var) shape(var,0)
#define flen(var) fshape(var,0)
#define old_size(var) PyArray_SIZE((PyArrayObject *)(capi_ ## var ## _tmp))
/* #define index(i) capi_i ## i */
#define slen(var) capi_ ## var ## _len
#define size(var, ...) f2py_size((PyArrayObject *)(capi_ ## var ## _tmp), ## __VA_ARGS__, -1)

#define STRINGFREE(str) do {if (!(str == NULL)) free(str);} while (0)

/*
STRINGPADN replaces null values with padding values from the right.

`to` must have size of at least N bytes.

If the `to[N-1]` has null value, then replace it and all the
preceding, nulls with the given padding.

STRINGPADN(to, N, PADDING, NULLVALUE) is an inverse operation.
*/
#define STRINGPADN(to, N, NULLVALUE, PADDING)                   \
    do {                                                        \
        int _m = (N);                                           \
        char *_to = (to);                                       \
        for (_m -= 1; _m >= 0 && _to[_m] == NULLVALUE; _m--) {  \
             _to[_m] = PADDING;                                 \
        }                                                       \
    } while (0)

#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(SCHAModules_error,errstring);\
        /*goto capi_fail;*/\
    } else 
#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif

#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif

/*
STRINGCOPYN copies N bytes.

`to` and `from` buffers must have sizes of at least N bytes.
*/
#define STRINGCOPYN(to,from,N)                                  \
    do {                                                        \
        int _m = (N);                                           \
        char *_to = (to);                                       \
        char *_from = (from);                                   \
        FAILNULL(_to); FAILNULL(_from);                         \
        (void)strncpy(_to, _from, _m);             \
    } while (0)


/************************ See f2py2e/cfuncs.py: cfuncs ************************/
static int f2py_size(PyArrayObject* var, ...)
{
  npy_int sz = 0;
  npy_int dim;
  npy_int rank;
  va_list argp;
  va_start(argp, var);
  dim = va_arg(argp, npy_int);
  if (dim==-1)
    {
      sz = PyArray_SIZE(var);
    }
  else
    {
      rank = PyArray_NDIM(var);
      if (dim>=1 && dim<=rank)
        sz = PyArray_DIM(var, dim-1);
      else
        fprintf(stderr, "f2py_size: 2nd argument value=%d fails to satisfy 1<=value<=%d. Result will be 0.\n", dim, rank);
    }
  va_end(argp);
  return sz;
}

static int
double_from_pyobj(double* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
        *v = PyFloat_AsDouble(obj);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    tmp = PyNumber_Float(obj);
    if (tmp) {
        *v = PyFloat_AsDouble(tmp);
        Py_DECREF(tmp);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = SCHAModules_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

/*
  Create a new string buffer `str` of at most length `len` from a
  Python string-like object `obj`.

  The string buffer has given size (len) or the size of inistr when len==-1.

  The string buffer is padded with blanks: in Fortran, trailing blanks
  are insignificant contrary to C nulls.
 */
static int
string_from_pyobj(string *str, int *len, const string inistr, PyObject *obj,
                  const char *errmess)
{
    PyObject *tmp = NULL;
    string buf = NULL;
    npy_intp n = -1;
#ifdef DEBUGCFUNCS
fprintf(stderr,"string_from_pyobj(str='%s',len=%d,inistr='%s',obj=%p)\n",
               (char*)str, *len, (char *)inistr, obj);
#endif
    if (obj == Py_None) {
        n = strlen(inistr);
        buf = inistr;
    }
    else if (PyArray_Check(obj)) {
        PyArrayObject *arr = (PyArrayObject *)obj;
        if (!ISCONTIGUOUS(arr)) {
            PyErr_SetString(PyExc_ValueError,
                            "array object is non-contiguous.");
            goto capi_fail;
        }
        n = PyArray_NBYTES(arr);
        buf = PyArray_DATA(arr);
        n = strnlen(buf, n);
    }
    else {
        if (PyBytes_Check(obj)) {
            tmp = obj;
            Py_INCREF(tmp);
        }
        else if (PyUnicode_Check(obj)) {
            tmp = PyUnicode_AsASCIIString(obj);
        }
        else {
            PyObject *tmp2;
            tmp2 = PyObject_Str(obj);
            if (tmp2) {
                tmp = PyUnicode_AsASCIIString(tmp2);
                Py_DECREF(tmp2);
            }
            else {
                tmp = NULL;
            }
        }
        if (tmp == NULL) goto capi_fail;
        n = PyBytes_GET_SIZE(tmp);
        buf = PyBytes_AS_STRING(tmp);
    }
    if (*len == -1) {
        /* TODO: change the type of `len` so that we can remove this */
        if (n > NPY_MAX_INT) {
            PyErr_SetString(PyExc_OverflowError,
                            "object too large for a 32-bit int");
            goto capi_fail;
        }
        *len = n;
    }
    else if (*len < n) {
        /* discard the last (len-n) bytes of input buf */
        n = *len;
    }
    if (n < 0 || *len < 0 || buf == NULL) {
        goto capi_fail;
    }
    STRINGMALLOC(*str, *len);  // *str is allocated with size (*len + 1)
    if (n < *len) {
        /*
          Pad fixed-width string with nulls. The caller will replace
          nulls with blanks when the corresponding argument is not
          intent(c).
        */
        memset(*str + n, '\0', *len - n);
    }
    STRINGCOPYN(*str, buf, n);
    Py_XDECREF(tmp);
    return 1;
capi_fail:
    Py_XDECREF(tmp);
    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = SCHAModules_error;
        }
        PyErr_SetString(err, errmess);
    }
    return 0;
}

static int
int_from_pyobj(int* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;

    if (PyLong_Check(obj)) {
        *v = Npy__PyLong_AsInt(obj);
        return !(*v == -1 && PyErr_Occurred());
    }

    tmp = PyNumber_Long(obj);
    if (tmp) {
        *v = Npy__PyLong_AsInt(tmp);
        Py_DECREF(tmp);
        return !(*v == -1 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (int_from_pyobj(v, tmp, errmess)) {
            Py_DECREF(tmp);
            return 1;
        }
        Py_DECREF(tmp);
    }

    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = SCHAModules_error;
        }
        PyErr_SetString(err, errmess);
    }
    return 0;
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
extern void F_FUNC_US(get_stress_tensor,GET_STRESS_TENSOR)(double*,double*,double*,double*,double*,double*,double*,double*,string,double*,double*,int*,int*,int*,size_t);
extern void F_FUNC_US(get_gradient_supercell,GET_GRADIENT_SUPERCELL)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t);
extern void F_FUNC_US(get_gradient_supercell_new,GET_GRADIENT_SUPERCELL_NEW)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,size_t);
extern void F_FUNC_US(get_upsilon_matrix,GET_UPSILON_MATRIX)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*);
extern void F_FUNC_US(get_fmunu,GET_FMUNU)(double*,double*,double*,double*);
extern void F_FUNC_US(multiply_lambda_tensor,MULTIPLY_LAMBDA_TENSOR)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*,double*,int*);
extern void F_FUNC_US(cell_force,CELL_FORCE)(double*,double*,double*,double*,double*,double*);
extern void F_FUNC_US(get_gradient_supercell_fast,GET_GRADIENT_SUPERCELL_FAST)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t);
extern void F_FUNC_US(get_unpreconditioned_gradient,GET_UNPRECONDITIONED_GRADIENT)(double*,double*,double*,double*,double*,double*,int*,double*,string,double*,double*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(get_ymu,GET_YMU)(double*,double*,double*);
extern void F_FUNC_US(get_g,GET_G)(double*,double*,int*,double*,double*,int*);
extern void F_FUNC_US(get_emat,GET_EMAT)(double*,double*,double*,int*,int*,int*,double*,int*,int*,int*);
extern void F_FUNC_US(get_v3,GET_V3)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(get_odd_straight,GET_ODD_STRAIGHT)(double*,double*,double*,int*,double*,int*,double*,double*,double*,int*,int*,int*);
extern void F_FUNC_US(get_cmat,GET_CMAT)(double*,double*,double*,int*,double*,int*,double*,int*,double*,int*,int*,int*);
extern void F_FUNC_US(get_v4,GET_V4)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(get_odd_straight_with_v4,GET_ODD_STRAIGHT_WITH_V4)(double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,int*,int*,int*);
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/***************************** get_stress_tensor *****************************/
static char doc_f2py_rout_SCHAModules_get_stress_tensor[] = "\
stress_tensor,error_on_stress_tensor = get_stress_tensor(volume,forces_e,u_vector,abinit_stress_tensors,wr,er,t,rho,log_err,[nrandom,natoms_sc,nmodes])\n\nWrapper for ``get_stress_tensor``.\
\n\nParameters\n----------\n"
"volume : input float\n"
"forces_e : input rank-3 array('d') with bounds (nrandom,natoms_sc,3)\n"
"u_vector : input rank-3 array('d') with bounds (nrandom,natoms_sc,3)\n"
"abinit_stress_tensors : input rank-3 array('d') with bounds (3,3,nrandom)\n"
"wr : input rank-1 array('d') with bounds (nmodes)\n"
"er : input rank-3 array('d') with bounds (natoms_sc,nmodes,3)\n"
"t : input float\n"
"rho : input rank-1 array('d') with bounds (nrandom)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"nrandom : input int, optional\n    Default: shape(forces_e, 0)\n"
"natoms_sc : input int, optional\n    Default: shape(forces_e, 1)\n"
"nmodes : input int, optional\n    Default: shape(wr, 0)\n"
"\nReturns\n-------\n"
"stress_tensor : rank-2 array('d') with bounds (3,3)\n"
"error_on_stress_tensor : rank-2 array('d') with bounds (3,3)";
/* extern void F_FUNC_US(get_stress_tensor,GET_STRESS_TENSOR)(double*,double*,double*,double*,double*,double*,double*,double*,string,double*,double*,int*,int*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_stress_tensor(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,double*,double*,string,double*,double*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double volume = 0;
    PyObject *volume_capi = Py_None;
    double *forces_e = NULL;
    npy_intp forces_e_Dims[3] = {-1, -1, -1};
    const int forces_e_Rank = 3;
    PyArrayObject *capi_forces_e_tmp = NULL;
    int capi_forces_e_intent = 0;
    PyObject *forces_e_capi = Py_None;
    double *u_vector = NULL;
    npy_intp u_vector_Dims[3] = {-1, -1, -1};
    const int u_vector_Rank = 3;
    PyArrayObject *capi_u_vector_tmp = NULL;
    int capi_u_vector_intent = 0;
    PyObject *u_vector_capi = Py_None;
    double *abinit_stress_tensors = NULL;
    npy_intp abinit_stress_tensors_Dims[3] = {-1, -1, -1};
    const int abinit_stress_tensors_Rank = 3;
    PyArrayObject *capi_abinit_stress_tensors_tmp = NULL;
    int capi_abinit_stress_tensors_intent = 0;
    PyObject *abinit_stress_tensors_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *stress_tensor = NULL;
    npy_intp stress_tensor_Dims[2] = {-1, -1};
    const int stress_tensor_Rank = 2;
    PyArrayObject *capi_stress_tensor_tmp = NULL;
    int capi_stress_tensor_intent = 0;
    double *error_on_stress_tensor = NULL;
    npy_intp error_on_stress_tensor_Dims[2] = {-1, -1};
    const int error_on_stress_tensor_Rank = 2;
    PyArrayObject *capi_error_on_stress_tensor_tmp = NULL;
    int capi_error_on_stress_tensor_intent = 0;
    int nrandom = 0;
    PyObject *nrandom_capi = Py_None;
    int natoms_sc = 0;
    PyObject *natoms_sc_capi = Py_None;
    int nmodes = 0;
    PyObject *nmodes_capi = Py_None;
    static char *capi_kwlist[] = {"volume","forces_e","u_vector","abinit_stress_tensors","wr","er","t","rho","log_err","nrandom","natoms_sc","nmodes",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOO:SCHAModules.get_stress_tensor",\
        capi_kwlist,&volume_capi,&forces_e_capi,&u_vector_capi,&abinit_stress_tensors_capi,&wr_capi,&er_capi,&t_capi,&rho_capi,&log_err_capi,&nrandom_capi,&natoms_sc_capi,&nmodes_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable volume */
        f2py_success = double_from_pyobj(&volume,volume_capi,"SCHAModules.get_stress_tensor() 1st argument (volume) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_stress_tensor() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable stress_tensor */
    stress_tensor_Dims[0]=3,stress_tensor_Dims[1]=3;
    capi_stress_tensor_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_stress_tensor_tmp = array_from_pyobj(NPY_DOUBLE,stress_tensor_Dims,stress_tensor_Rank,capi_stress_tensor_intent,Py_None);
    if (capi_stress_tensor_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `stress_tensor' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        stress_tensor = (double *)(PyArray_DATA(capi_stress_tensor_tmp));

    /* Processing variable error_on_stress_tensor */
    error_on_stress_tensor_Dims[0]=3,error_on_stress_tensor_Dims[1]=3;
    capi_error_on_stress_tensor_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_error_on_stress_tensor_tmp = array_from_pyobj(NPY_DOUBLE,error_on_stress_tensor_Dims,error_on_stress_tensor_Rank,capi_error_on_stress_tensor_intent,Py_None);
    if (capi_error_on_stress_tensor_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `error_on_stress_tensor' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        error_on_stress_tensor = (double *)(PyArray_DATA(capi_error_on_stress_tensor_tmp));

    /* Processing variable wr */
    ;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `wr' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable forces_e */
    forces_e_Dims[2]=3;
    capi_forces_e_intent |= F2PY_INTENT_IN;
    capi_forces_e_tmp = array_from_pyobj(NPY_DOUBLE,forces_e_Dims,forces_e_Rank,capi_forces_e_intent,forces_e_capi);
    if (capi_forces_e_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `forces_e' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        forces_e = (double *)(PyArray_DATA(capi_forces_e_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 9th argument`log_err' of SCHAModules.get_stress_tensor to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable nrandom */
    if (nrandom_capi == Py_None) nrandom = shape(forces_e, 0); else
        f2py_success = int_from_pyobj(&nrandom,nrandom_capi,"SCHAModules.get_stress_tensor() 1st keyword (nrandom) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(forces_e, 0) == nrandom,"shape(forces_e, 0) == nrandom","1st keyword nrandom","get_stress_tensor:nrandom=%d",nrandom) {
    /* Processing variable natoms_sc */
    if (natoms_sc_capi == Py_None) natoms_sc = shape(forces_e, 1); else
        f2py_success = int_from_pyobj(&natoms_sc,natoms_sc_capi,"SCHAModules.get_stress_tensor() 2nd keyword (natoms_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(forces_e, 1) == natoms_sc,"shape(forces_e, 1) == natoms_sc","2nd keyword natoms_sc","get_stress_tensor:natoms_sc=%d",natoms_sc) {
    /* Processing variable nmodes */
    if (nmodes_capi == Py_None) nmodes = shape(wr, 0); else
        f2py_success = int_from_pyobj(&nmodes,nmodes_capi,"SCHAModules.get_stress_tensor() 3rd keyword (nmodes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr, 0) == nmodes,"shape(wr, 0) == nmodes","3rd keyword nmodes","get_stress_tensor:nmodes=%d",nmodes) {
    /* Processing variable abinit_stress_tensors */
    abinit_stress_tensors_Dims[0]=3,abinit_stress_tensors_Dims[1]=3,abinit_stress_tensors_Dims[2]=nrandom;
    capi_abinit_stress_tensors_intent |= F2PY_INTENT_IN;
    capi_abinit_stress_tensors_tmp = array_from_pyobj(NPY_DOUBLE,abinit_stress_tensors_Dims,abinit_stress_tensors_Rank,capi_abinit_stress_tensors_intent,abinit_stress_tensors_capi);
    if (capi_abinit_stress_tensors_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `abinit_stress_tensors' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        abinit_stress_tensors = (double *)(PyArray_DATA(capi_abinit_stress_tensors_tmp));

    /* Processing variable rho */
    rho_Dims[0]=nrandom;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `rho' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable er */
    er_Dims[0]=natoms_sc,er_Dims[1]=nmodes,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `er' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable u_vector */
    u_vector_Dims[0]=nrandom,u_vector_Dims[1]=natoms_sc,u_vector_Dims[2]=3;
    capi_u_vector_intent |= F2PY_INTENT_IN;
    capi_u_vector_tmp = array_from_pyobj(NPY_DOUBLE,u_vector_Dims,u_vector_Rank,capi_u_vector_intent,u_vector_capi);
    if (capi_u_vector_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `u_vector' of SCHAModules.get_stress_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u_vector = (double *)(PyArray_DATA(capi_u_vector_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&volume,forces_e,u_vector,abinit_stress_tensors,wr,er,&t,rho,log_err,stress_tensor,error_on_stress_tensor,&nrandom,&natoms_sc,&nmodes,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_stress_tensor_tmp,capi_error_on_stress_tensor_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_u_vector_tmp!=u_vector_capi) {
        Py_XDECREF(capi_u_vector_tmp); }
    }  /*if (capi_u_vector_tmp == NULL) ... else of u_vector*/
    /* End of cleaning variable u_vector */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_abinit_stress_tensors_tmp!=abinit_stress_tensors_capi) {
        Py_XDECREF(capi_abinit_stress_tensors_tmp); }
    }  /*if (capi_abinit_stress_tensors_tmp == NULL) ... else of abinit_stress_tensors*/
    /* End of cleaning variable abinit_stress_tensors */
    } /*CHECKSCALAR(shape(wr, 0) == nmodes)*/
    } /*if (f2py_success) of nmodes*/
    /* End of cleaning variable nmodes */
    } /*CHECKSCALAR(shape(forces_e, 1) == natoms_sc)*/
    } /*if (f2py_success) of natoms_sc*/
    /* End of cleaning variable natoms_sc */
    } /*CHECKSCALAR(shape(forces_e, 0) == nrandom)*/
    } /*if (f2py_success) of nrandom*/
    /* End of cleaning variable nrandom */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_forces_e_tmp!=forces_e_capi) {
        Py_XDECREF(capi_forces_e_tmp); }
    }  /*if (capi_forces_e_tmp == NULL) ... else of forces_e*/
    /* End of cleaning variable forces_e */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
    }  /*if (capi_error_on_stress_tensor_tmp == NULL) ... else of error_on_stress_tensor*/
    /* End of cleaning variable error_on_stress_tensor */
    }  /*if (capi_stress_tensor_tmp == NULL) ... else of stress_tensor*/
    /* End of cleaning variable stress_tensor */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of volume*/
    /* End of cleaning variable volume */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of get_stress_tensor **************************/

/*************************** get_gradient_supercell ***************************/
static char doc_f2py_rout_SCHAModules_get_gradient_supercell[] = "\
grad,grad_err = get_gradient_supercell(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,[n_random,natsc,n_modes,ntyp_sc,preconditioned])\n\nWrapper for ``get_gradient_supercell``.\
\n\nParameters\n----------\n"
"rho : input rank-1 array('d') with bounds (n_random)\n"
"u_disp : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"eforces : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"wr_sc : input rank-1 array('d') with bounds (n_modes)\n"
"epols_sc : input rank-2 array('d') with bounds (3 * natsc,n_modes)\n"
"trans : input rank-1 array('i') with bounds (n_modes)\n"
"t : input float\n"
"mass : input rank-1 array('d') with bounds (ntyp_sc)\n"
"ityp_sc : input rank-1 array('i') with bounds (natsc)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"n_random : input int, optional\n    Default: shape(rho, 0)\n"
"natsc : input int, optional\n    Default: shape(u_disp, 1)\n"
"n_modes : input int, optional\n    Default: shape(wr_sc, 0)\n"
"ntyp_sc : input int, optional\n    Default: shape(mass, 0)\n"
"preconditioned : input int\n"
"\nReturns\n-------\n"
"grad : rank-2 array('d') with bounds (3 * natsc,3 * natsc)\n"
"grad_err : rank-2 array('d') with bounds (3 * natsc,3 * natsc)";
/* extern void F_FUNC_US(get_gradient_supercell,GET_GRADIENT_SUPERCELL)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_gradient_supercell(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int n_random = 0;
    PyObject *n_random_capi = Py_None;
    int natsc = 0;
    PyObject *natsc_capi = Py_None;
    int n_modes = 0;
    PyObject *n_modes_capi = Py_None;
    int ntyp_sc = 0;
    PyObject *ntyp_sc_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    double *u_disp = NULL;
    npy_intp u_disp_Dims[3] = {-1, -1, -1};
    const int u_disp_Rank = 3;
    PyArrayObject *capi_u_disp_tmp = NULL;
    int capi_u_disp_intent = 0;
    PyObject *u_disp_capi = Py_None;
    double *eforces = NULL;
    npy_intp eforces_Dims[3] = {-1, -1, -1};
    const int eforces_Rank = 3;
    PyArrayObject *capi_eforces_tmp = NULL;
    int capi_eforces_intent = 0;
    PyObject *eforces_capi = Py_None;
    double *wr_sc = NULL;
    npy_intp wr_sc_Dims[1] = {-1};
    const int wr_sc_Rank = 1;
    PyArrayObject *capi_wr_sc_tmp = NULL;
    int capi_wr_sc_intent = 0;
    PyObject *wr_sc_capi = Py_None;
    double *epols_sc = NULL;
    npy_intp epols_sc_Dims[2] = {-1, -1};
    const int epols_sc_Rank = 2;
    PyArrayObject *capi_epols_sc_tmp = NULL;
    int capi_epols_sc_intent = 0;
    PyObject *epols_sc_capi = Py_None;
    int *trans = NULL;
    npy_intp trans_Dims[1] = {-1};
    const int trans_Rank = 1;
    PyArrayObject *capi_trans_tmp = NULL;
    int capi_trans_intent = 0;
    PyObject *trans_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *grad = NULL;
    npy_intp grad_Dims[2] = {-1, -1};
    const int grad_Rank = 2;
    PyArrayObject *capi_grad_tmp = NULL;
    int capi_grad_intent = 0;
    double *grad_err = NULL;
    npy_intp grad_err_Dims[2] = {-1, -1};
    const int grad_err_Rank = 2;
    PyArrayObject *capi_grad_err_tmp = NULL;
    int capi_grad_err_intent = 0;
    int preconditioned = 0;
    PyObject *preconditioned_capi = Py_None;
    static char *capi_kwlist[] = {"rho","u_disp","eforces","wr_sc","epols_sc","trans","t","mass","ityp_sc","log_err","n_random","natsc","n_modes","ntyp_sc","preconditioned",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOO|OOOOO:SCHAModules.get_gradient_supercell",\
        capi_kwlist,&rho_capi,&u_disp_capi,&eforces_capi,&wr_sc_capi,&epols_sc_capi,&trans_capi,&t_capi,&mass_capi,&ityp_sc_capi,&log_err_capi,&n_random_capi,&natsc_capi,&n_modes_capi,&ntyp_sc_capi,&preconditioned_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable rho */
    ;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `rho' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable wr_sc */
    ;
    capi_wr_sc_intent |= F2PY_INTENT_IN;
    capi_wr_sc_tmp = array_from_pyobj(NPY_DOUBLE,wr_sc_Dims,wr_sc_Rank,capi_wr_sc_intent,wr_sc_capi);
    if (capi_wr_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `wr_sc' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr_sc = (double *)(PyArray_DATA(capi_wr_sc_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_gradient_supercell() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `mass' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 10th argument`log_err' of SCHAModules.get_gradient_supercell to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable preconditioned */
    if (preconditioned_capi != Py_None)
        preconditioned = (int)PyObject_IsTrue(preconditioned_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable n_random */
    if (n_random_capi == Py_None) n_random = shape(rho, 0); else
        f2py_success = int_from_pyobj(&n_random,n_random_capi,"SCHAModules.get_gradient_supercell() 1st keyword (n_random) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(rho, 0) == n_random,"shape(rho, 0) == n_random","1st keyword n_random","get_gradient_supercell:n_random=%d",n_random) {
    /* Processing variable n_modes */
    if (n_modes_capi == Py_None) n_modes = shape(wr_sc, 0); else
        f2py_success = int_from_pyobj(&n_modes,n_modes_capi,"SCHAModules.get_gradient_supercell() 3rd keyword (n_modes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr_sc, 0) == n_modes,"shape(wr_sc, 0) == n_modes","3rd keyword n_modes","get_gradient_supercell:n_modes=%d",n_modes) {
    /* Processing variable ntyp_sc */
    if (ntyp_sc_capi == Py_None) ntyp_sc = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp_sc,ntyp_sc_capi,"SCHAModules.get_gradient_supercell() 4th keyword (ntyp_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp_sc,"shape(mass, 0) == ntyp_sc","4th keyword ntyp_sc","get_gradient_supercell:ntyp_sc=%d",ntyp_sc) {
    /* Processing variable u_disp */
    u_disp_Dims[0]=n_random,u_disp_Dims[2]=3;
    capi_u_disp_intent |= F2PY_INTENT_IN;
    capi_u_disp_tmp = array_from_pyobj(NPY_DOUBLE,u_disp_Dims,u_disp_Rank,capi_u_disp_intent,u_disp_capi);
    if (capi_u_disp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `u_disp' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u_disp = (double *)(PyArray_DATA(capi_u_disp_tmp));

    /* Processing variable trans */
    trans_Dims[0]=n_modes;
    capi_trans_intent |= F2PY_INTENT_IN;
    capi_trans_tmp = array_from_pyobj(NPY_INT,trans_Dims,trans_Rank,capi_trans_intent,trans_capi);
    if (capi_trans_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `trans' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        trans = (int *)(PyArray_DATA(capi_trans_tmp));

    /* Processing variable natsc */
    if (natsc_capi == Py_None) natsc = shape(u_disp, 1); else
        f2py_success = int_from_pyobj(&natsc,natsc_capi,"SCHAModules.get_gradient_supercell() 2nd keyword (natsc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(u_disp, 1) == natsc,"shape(u_disp, 1) == natsc","2nd keyword natsc","get_gradient_supercell:natsc=%d",natsc) {
    /* Processing variable eforces */
    eforces_Dims[0]=n_random,eforces_Dims[1]=natsc,eforces_Dims[2]=3;
    capi_eforces_intent |= F2PY_INTENT_IN;
    capi_eforces_tmp = array_from_pyobj(NPY_DOUBLE,eforces_Dims,eforces_Rank,capi_eforces_intent,eforces_capi);
    if (capi_eforces_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `eforces' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        eforces = (double *)(PyArray_DATA(capi_eforces_tmp));

    /* Processing variable epols_sc */
    epols_sc_Dims[0]=3 * natsc,epols_sc_Dims[1]=n_modes;
    capi_epols_sc_intent |= F2PY_INTENT_IN;
    capi_epols_sc_tmp = array_from_pyobj(NPY_DOUBLE,epols_sc_Dims,epols_sc_Rank,capi_epols_sc_intent,epols_sc_capi);
    if (capi_epols_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `epols_sc' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        epols_sc = (double *)(PyArray_DATA(capi_epols_sc_tmp));

    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=natsc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 9th argument `ityp_sc' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable grad */
    grad_Dims[0]=3 * natsc,grad_Dims[1]=3 * natsc;
    capi_grad_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_tmp = array_from_pyobj(NPY_DOUBLE,grad_Dims,grad_Rank,capi_grad_intent,Py_None);
    if (capi_grad_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad = (double *)(PyArray_DATA(capi_grad_tmp));

    /* Processing variable grad_err */
    grad_err_Dims[0]=3 * natsc,grad_err_Dims[1]=3 * natsc;
    capi_grad_err_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_err_tmp = array_from_pyobj(NPY_DOUBLE,grad_err_Dims,grad_err_Rank,capi_grad_err_intent,Py_None);
    if (capi_grad_err_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad_err' of SCHAModules.get_gradient_supercell to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad_err = (double *)(PyArray_DATA(capi_grad_err_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&n_random,&natsc,&n_modes,&ntyp_sc,rho,u_disp,eforces,wr_sc,epols_sc,trans,&t,mass,ityp_sc,log_err,grad,grad_err,&preconditioned,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_grad_tmp,capi_grad_err_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_grad_err_tmp == NULL) ... else of grad_err*/
    /* End of cleaning variable grad_err */
    }  /*if (capi_grad_tmp == NULL) ... else of grad*/
    /* End of cleaning variable grad */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    if((PyObject *)capi_epols_sc_tmp!=epols_sc_capi) {
        Py_XDECREF(capi_epols_sc_tmp); }
    }  /*if (capi_epols_sc_tmp == NULL) ... else of epols_sc*/
    /* End of cleaning variable epols_sc */
    if((PyObject *)capi_eforces_tmp!=eforces_capi) {
        Py_XDECREF(capi_eforces_tmp); }
    }  /*if (capi_eforces_tmp == NULL) ... else of eforces*/
    /* End of cleaning variable eforces */
    } /*CHECKSCALAR(shape(u_disp, 1) == natsc)*/
    } /*if (f2py_success) of natsc*/
    /* End of cleaning variable natsc */
    if((PyObject *)capi_trans_tmp!=trans_capi) {
        Py_XDECREF(capi_trans_tmp); }
    }  /*if (capi_trans_tmp == NULL) ... else of trans*/
    /* End of cleaning variable trans */
    if((PyObject *)capi_u_disp_tmp!=u_disp_capi) {
        Py_XDECREF(capi_u_disp_tmp); }
    }  /*if (capi_u_disp_tmp == NULL) ... else of u_disp*/
    /* End of cleaning variable u_disp */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp_sc)*/
    } /*if (f2py_success) of ntyp_sc*/
    /* End of cleaning variable ntyp_sc */
    } /*CHECKSCALAR(shape(wr_sc, 0) == n_modes)*/
    } /*if (f2py_success) of n_modes*/
    /* End of cleaning variable n_modes */
    } /*CHECKSCALAR(shape(rho, 0) == n_random)*/
    } /*if (f2py_success) of n_random*/
    /* End of cleaning variable n_random */
    } /*if (f2py_success) of preconditioned*/
    /* End of cleaning variable preconditioned */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_wr_sc_tmp!=wr_sc_capi) {
        Py_XDECREF(capi_wr_sc_tmp); }
    }  /*if (capi_wr_sc_tmp == NULL) ... else of wr_sc*/
    /* End of cleaning variable wr_sc */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*********************** end of get_gradient_supercell ***********************/

/************************* get_gradient_supercell_new *************************/
static char doc_f2py_rout_SCHAModules_get_gradient_supercell_new[] = "\
grad,grad_err = get_gradient_supercell_new(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,[n_random,natsc,n_modes,ntyp_sc])\n\nWrapper for ``get_gradient_supercell_new``.\
\n\nParameters\n----------\n"
"rho : input rank-1 array('d') with bounds (n_random)\n"
"u_disp : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"eforces : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"wr_sc : input rank-1 array('d') with bounds (n_modes)\n"
"epols_sc : input rank-2 array('d') with bounds (3 * natsc,n_modes)\n"
"trans : input rank-1 array('i') with bounds (n_modes)\n"
"t : input float\n"
"mass : input rank-1 array('d') with bounds (ntyp_sc)\n"
"ityp_sc : input rank-1 array('i') with bounds (natsc)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"n_random : input int, optional\n    Default: shape(rho, 0)\n"
"natsc : input int, optional\n    Default: shape(u_disp, 1)\n"
"n_modes : input int, optional\n    Default: shape(wr_sc, 0)\n"
"ntyp_sc : input int, optional\n    Default: shape(mass, 0)\n"
"\nReturns\n-------\n"
"grad : rank-2 array('d') with bounds (3 * natsc,3 * natsc)\n"
"grad_err : rank-2 array('d') with bounds (3 * natsc,3 * natsc)";
/* extern void F_FUNC_US(get_gradient_supercell_new,GET_GRADIENT_SUPERCELL_NEW)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_gradient_supercell_new(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int n_random = 0;
    PyObject *n_random_capi = Py_None;
    int natsc = 0;
    PyObject *natsc_capi = Py_None;
    int n_modes = 0;
    PyObject *n_modes_capi = Py_None;
    int ntyp_sc = 0;
    PyObject *ntyp_sc_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    double *u_disp = NULL;
    npy_intp u_disp_Dims[3] = {-1, -1, -1};
    const int u_disp_Rank = 3;
    PyArrayObject *capi_u_disp_tmp = NULL;
    int capi_u_disp_intent = 0;
    PyObject *u_disp_capi = Py_None;
    double *eforces = NULL;
    npy_intp eforces_Dims[3] = {-1, -1, -1};
    const int eforces_Rank = 3;
    PyArrayObject *capi_eforces_tmp = NULL;
    int capi_eforces_intent = 0;
    PyObject *eforces_capi = Py_None;
    double *wr_sc = NULL;
    npy_intp wr_sc_Dims[1] = {-1};
    const int wr_sc_Rank = 1;
    PyArrayObject *capi_wr_sc_tmp = NULL;
    int capi_wr_sc_intent = 0;
    PyObject *wr_sc_capi = Py_None;
    double *epols_sc = NULL;
    npy_intp epols_sc_Dims[2] = {-1, -1};
    const int epols_sc_Rank = 2;
    PyArrayObject *capi_epols_sc_tmp = NULL;
    int capi_epols_sc_intent = 0;
    PyObject *epols_sc_capi = Py_None;
    int *trans = NULL;
    npy_intp trans_Dims[1] = {-1};
    const int trans_Rank = 1;
    PyArrayObject *capi_trans_tmp = NULL;
    int capi_trans_intent = 0;
    PyObject *trans_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *grad = NULL;
    npy_intp grad_Dims[2] = {-1, -1};
    const int grad_Rank = 2;
    PyArrayObject *capi_grad_tmp = NULL;
    int capi_grad_intent = 0;
    double *grad_err = NULL;
    npy_intp grad_err_Dims[2] = {-1, -1};
    const int grad_err_Rank = 2;
    PyArrayObject *capi_grad_err_tmp = NULL;
    int capi_grad_err_intent = 0;
    static char *capi_kwlist[] = {"rho","u_disp","eforces","wr_sc","epols_sc","trans","t","mass","ityp_sc","log_err","n_random","natsc","n_modes","ntyp_sc",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOO|OOOO:SCHAModules.get_gradient_supercell_new",\
        capi_kwlist,&rho_capi,&u_disp_capi,&eforces_capi,&wr_sc_capi,&epols_sc_capi,&trans_capi,&t_capi,&mass_capi,&ityp_sc_capi,&log_err_capi,&n_random_capi,&natsc_capi,&n_modes_capi,&ntyp_sc_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable rho */
    ;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `rho' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable wr_sc */
    ;
    capi_wr_sc_intent |= F2PY_INTENT_IN;
    capi_wr_sc_tmp = array_from_pyobj(NPY_DOUBLE,wr_sc_Dims,wr_sc_Rank,capi_wr_sc_intent,wr_sc_capi);
    if (capi_wr_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `wr_sc' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr_sc = (double *)(PyArray_DATA(capi_wr_sc_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_gradient_supercell_new() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `mass' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 10th argument`log_err' of SCHAModules.get_gradient_supercell_new to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable n_random */
    if (n_random_capi == Py_None) n_random = shape(rho, 0); else
        f2py_success = int_from_pyobj(&n_random,n_random_capi,"SCHAModules.get_gradient_supercell_new() 1st keyword (n_random) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(rho, 0) == n_random,"shape(rho, 0) == n_random","1st keyword n_random","get_gradient_supercell_new:n_random=%d",n_random) {
    /* Processing variable n_modes */
    if (n_modes_capi == Py_None) n_modes = shape(wr_sc, 0); else
        f2py_success = int_from_pyobj(&n_modes,n_modes_capi,"SCHAModules.get_gradient_supercell_new() 3rd keyword (n_modes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr_sc, 0) == n_modes,"shape(wr_sc, 0) == n_modes","3rd keyword n_modes","get_gradient_supercell_new:n_modes=%d",n_modes) {
    /* Processing variable ntyp_sc */
    if (ntyp_sc_capi == Py_None) ntyp_sc = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp_sc,ntyp_sc_capi,"SCHAModules.get_gradient_supercell_new() 4th keyword (ntyp_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp_sc,"shape(mass, 0) == ntyp_sc","4th keyword ntyp_sc","get_gradient_supercell_new:ntyp_sc=%d",ntyp_sc) {
    /* Processing variable u_disp */
    u_disp_Dims[0]=n_random,u_disp_Dims[2]=3;
    capi_u_disp_intent |= F2PY_INTENT_IN;
    capi_u_disp_tmp = array_from_pyobj(NPY_DOUBLE,u_disp_Dims,u_disp_Rank,capi_u_disp_intent,u_disp_capi);
    if (capi_u_disp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `u_disp' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u_disp = (double *)(PyArray_DATA(capi_u_disp_tmp));

    /* Processing variable trans */
    trans_Dims[0]=n_modes;
    capi_trans_intent |= F2PY_INTENT_IN;
    capi_trans_tmp = array_from_pyobj(NPY_INT,trans_Dims,trans_Rank,capi_trans_intent,trans_capi);
    if (capi_trans_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `trans' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        trans = (int *)(PyArray_DATA(capi_trans_tmp));

    /* Processing variable natsc */
    if (natsc_capi == Py_None) natsc = shape(u_disp, 1); else
        f2py_success = int_from_pyobj(&natsc,natsc_capi,"SCHAModules.get_gradient_supercell_new() 2nd keyword (natsc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(u_disp, 1) == natsc,"shape(u_disp, 1) == natsc","2nd keyword natsc","get_gradient_supercell_new:natsc=%d",natsc) {
    /* Processing variable eforces */
    eforces_Dims[0]=n_random,eforces_Dims[1]=natsc,eforces_Dims[2]=3;
    capi_eforces_intent |= F2PY_INTENT_IN;
    capi_eforces_tmp = array_from_pyobj(NPY_DOUBLE,eforces_Dims,eforces_Rank,capi_eforces_intent,eforces_capi);
    if (capi_eforces_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `eforces' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        eforces = (double *)(PyArray_DATA(capi_eforces_tmp));

    /* Processing variable epols_sc */
    epols_sc_Dims[0]=3 * natsc,epols_sc_Dims[1]=n_modes;
    capi_epols_sc_intent |= F2PY_INTENT_IN;
    capi_epols_sc_tmp = array_from_pyobj(NPY_DOUBLE,epols_sc_Dims,epols_sc_Rank,capi_epols_sc_intent,epols_sc_capi);
    if (capi_epols_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `epols_sc' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        epols_sc = (double *)(PyArray_DATA(capi_epols_sc_tmp));

    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=natsc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 9th argument `ityp_sc' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable grad */
    grad_Dims[0]=3 * natsc,grad_Dims[1]=3 * natsc;
    capi_grad_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_tmp = array_from_pyobj(NPY_DOUBLE,grad_Dims,grad_Rank,capi_grad_intent,Py_None);
    if (capi_grad_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad = (double *)(PyArray_DATA(capi_grad_tmp));

    /* Processing variable grad_err */
    grad_err_Dims[0]=3 * natsc,grad_err_Dims[1]=3 * natsc;
    capi_grad_err_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_err_tmp = array_from_pyobj(NPY_DOUBLE,grad_err_Dims,grad_err_Rank,capi_grad_err_intent,Py_None);
    if (capi_grad_err_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad_err' of SCHAModules.get_gradient_supercell_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad_err = (double *)(PyArray_DATA(capi_grad_err_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&n_random,&natsc,&n_modes,&ntyp_sc,rho,u_disp,eforces,wr_sc,epols_sc,trans,&t,mass,ityp_sc,log_err,grad,grad_err,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_grad_tmp,capi_grad_err_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_grad_err_tmp == NULL) ... else of grad_err*/
    /* End of cleaning variable grad_err */
    }  /*if (capi_grad_tmp == NULL) ... else of grad*/
    /* End of cleaning variable grad */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    if((PyObject *)capi_epols_sc_tmp!=epols_sc_capi) {
        Py_XDECREF(capi_epols_sc_tmp); }
    }  /*if (capi_epols_sc_tmp == NULL) ... else of epols_sc*/
    /* End of cleaning variable epols_sc */
    if((PyObject *)capi_eforces_tmp!=eforces_capi) {
        Py_XDECREF(capi_eforces_tmp); }
    }  /*if (capi_eforces_tmp == NULL) ... else of eforces*/
    /* End of cleaning variable eforces */
    } /*CHECKSCALAR(shape(u_disp, 1) == natsc)*/
    } /*if (f2py_success) of natsc*/
    /* End of cleaning variable natsc */
    if((PyObject *)capi_trans_tmp!=trans_capi) {
        Py_XDECREF(capi_trans_tmp); }
    }  /*if (capi_trans_tmp == NULL) ... else of trans*/
    /* End of cleaning variable trans */
    if((PyObject *)capi_u_disp_tmp!=u_disp_capi) {
        Py_XDECREF(capi_u_disp_tmp); }
    }  /*if (capi_u_disp_tmp == NULL) ... else of u_disp*/
    /* End of cleaning variable u_disp */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp_sc)*/
    } /*if (f2py_success) of ntyp_sc*/
    /* End of cleaning variable ntyp_sc */
    } /*CHECKSCALAR(shape(wr_sc, 0) == n_modes)*/
    } /*if (f2py_success) of n_modes*/
    /* End of cleaning variable n_modes */
    } /*CHECKSCALAR(shape(rho, 0) == n_random)*/
    } /*if (f2py_success) of n_random*/
    /* End of cleaning variable n_random */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_wr_sc_tmp!=wr_sc_capi) {
        Py_XDECREF(capi_wr_sc_tmp); }
    }  /*if (capi_wr_sc_tmp == NULL) ... else of wr_sc*/
    /* End of cleaning variable wr_sc */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************* end of get_gradient_supercell_new *********************/

/***************************** get_upsilon_matrix *****************************/
static char doc_f2py_rout_SCHAModules_get_upsilon_matrix[] = "\
ups = get_upsilon_matrix(wr,epols,trans,mass,ityp,t,[nmodes,nat,ntyp])\n\nWrapper for ``get_upsilon_matrix``.\
\n\nParameters\n----------\n"
"wr : input rank-1 array('d') with bounds (nmodes)\n"
"epols : input rank-2 array('d') with bounds (3 * nat,nmodes)\n"
"trans : input rank-1 array('i') with bounds (nmodes)\n"
"mass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp : input rank-1 array('i') with bounds (nat)\n"
"t : input float\n"
"\nOther Parameters\n----------------\n"
"nmodes : input int, optional\n    Default: shape(wr, 0)\n"
"nat : input int, optional\n    Default: shape(epols, 0) / 3\n"
"ntyp : input int, optional\n    Default: shape(mass, 0)\n"
"\nReturns\n-------\n"
"ups : rank-2 array('d') with bounds (3 * nat,3 * nat)";
/* extern void F_FUNC_US(get_upsilon_matrix,GET_UPSILON_MATRIX)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*); */
static PyObject *f2py_rout_SCHAModules_get_upsilon_matrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int nmodes = 0;
    PyObject *nmodes_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *epols = NULL;
    npy_intp epols_Dims[2] = {-1, -1};
    const int epols_Rank = 2;
    PyArrayObject *capi_epols_tmp = NULL;
    int capi_epols_intent = 0;
    PyObject *epols_capi = Py_None;
    int *trans = NULL;
    npy_intp trans_Dims[1] = {-1};
    const int trans_Rank = 1;
    PyArrayObject *capi_trans_tmp = NULL;
    int capi_trans_intent = 0;
    PyObject *trans_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp = NULL;
    npy_intp ityp_Dims[1] = {-1};
    const int ityp_Rank = 1;
    PyArrayObject *capi_ityp_tmp = NULL;
    int capi_ityp_intent = 0;
    PyObject *ityp_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *ups = NULL;
    npy_intp ups_Dims[2] = {-1, -1};
    const int ups_Rank = 2;
    PyArrayObject *capi_ups_tmp = NULL;
    int capi_ups_intent = 0;
    static char *capi_kwlist[] = {"wr","epols","trans","mass","ityp","t","nmodes","nat","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OOO:SCHAModules.get_upsilon_matrix",\
        capi_kwlist,&wr_capi,&epols_capi,&trans_capi,&mass_capi,&ityp_capi,&t_capi,&nmodes_capi,&nat_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable wr */
    ;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `wr' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `mass' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_upsilon_matrix() 6th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nmodes */
    if (nmodes_capi == Py_None) nmodes = shape(wr, 0); else
        f2py_success = int_from_pyobj(&nmodes,nmodes_capi,"SCHAModules.get_upsilon_matrix() 1st keyword (nmodes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr, 0) == nmodes,"shape(wr, 0) == nmodes","1st keyword nmodes","get_upsilon_matrix:nmodes=%d",nmodes) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_upsilon_matrix() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp,"shape(mass, 0) == ntyp","3rd keyword ntyp","get_upsilon_matrix:ntyp=%d",ntyp) {
    /* Processing variable epols */
    epols_Dims[1]=nmodes;
    capi_epols_intent |= F2PY_INTENT_IN;
    capi_epols_tmp = array_from_pyobj(NPY_DOUBLE,epols_Dims,epols_Rank,capi_epols_intent,epols_capi);
    if (capi_epols_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `epols' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        epols = (double *)(PyArray_DATA(capi_epols_tmp));

    /* Processing variable trans */
    trans_Dims[0]=nmodes;
    capi_trans_intent |= F2PY_INTENT_IN;
    capi_trans_tmp = array_from_pyobj(NPY_INT,trans_Dims,trans_Rank,capi_trans_intent,trans_capi);
    if (capi_trans_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `trans' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        trans = (int *)(PyArray_DATA(capi_trans_tmp));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(epols, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"SCHAModules.get_upsilon_matrix() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(epols, 0) == 3 * nat,"shape(epols, 0) == 3 * nat","2nd keyword nat","get_upsilon_matrix:nat=%d",nat) {
    /* Processing variable ityp */
    ityp_Dims[0]=nat;
    capi_ityp_intent |= F2PY_INTENT_IN;
    capi_ityp_tmp = array_from_pyobj(NPY_INT,ityp_Dims,ityp_Rank,capi_ityp_intent,ityp_capi);
    if (capi_ityp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `ityp' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp = (int *)(PyArray_DATA(capi_ityp_tmp));

    /* Processing variable ups */
    ups_Dims[0]=3 * nat,ups_Dims[1]=3 * nat;
    capi_ups_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_ups_tmp = array_from_pyobj(NPY_DOUBLE,ups_Dims,ups_Rank,capi_ups_intent,Py_None);
    if (capi_ups_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `ups' of SCHAModules.get_upsilon_matrix to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ups = (double *)(PyArray_DATA(capi_ups_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&nmodes,&nat,&ntyp,wr,epols,trans,mass,ityp,&t,ups);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_ups_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_ups_tmp == NULL) ... else of ups*/
    /* End of cleaning variable ups */
    if((PyObject *)capi_ityp_tmp!=ityp_capi) {
        Py_XDECREF(capi_ityp_tmp); }
    }  /*if (capi_ityp_tmp == NULL) ... else of ityp*/
    /* End of cleaning variable ityp */
    } /*CHECKSCALAR(shape(epols, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_trans_tmp!=trans_capi) {
        Py_XDECREF(capi_trans_tmp); }
    }  /*if (capi_trans_tmp == NULL) ... else of trans*/
    /* End of cleaning variable trans */
    if((PyObject *)capi_epols_tmp!=epols_capi) {
        Py_XDECREF(capi_epols_tmp); }
    }  /*if (capi_epols_tmp == NULL) ... else of epols*/
    /* End of cleaning variable epols */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(wr, 0) == nmodes)*/
    } /*if (f2py_success) of nmodes*/
    /* End of cleaning variable nmodes */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of get_upsilon_matrix *************************/

/********************************* get_fmunu *********************************/
static char doc_f2py_rout_SCHAModules_get_fmunu[] = "\
f_munu = get_fmunu(w_mu,w_nu,t)\n\nWrapper for ``get_fmunu``.\
\n\nParameters\n----------\n"
"w_mu : input float\n"
"w_nu : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"f_munu : float";
/* extern void F_FUNC_US(get_fmunu,GET_FMUNU)(double*,double*,double*,double*); */
static PyObject *f2py_rout_SCHAModules_get_fmunu(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double w_mu = 0;
    PyObject *w_mu_capi = Py_None;
    double w_nu = 0;
    PyObject *w_nu_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double f_munu = 0;
    static char *capi_kwlist[] = {"w_mu","w_nu","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:SCHAModules.get_fmunu",\
        capi_kwlist,&w_mu_capi,&w_nu_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable f_munu */
    /* Processing variable w_mu */
        f2py_success = double_from_pyobj(&w_mu,w_mu_capi,"SCHAModules.get_fmunu() 1st argument (w_mu) can't be converted to double");
    if (f2py_success) {
    /* Processing variable w_nu */
        f2py_success = double_from_pyobj(&w_nu,w_nu_capi,"SCHAModules.get_fmunu() 2nd argument (w_nu) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_fmunu() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&w_mu,&w_nu,&t,&f_munu);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",f_munu);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of w_nu*/
    /* End of cleaning variable w_nu */
    } /*if (f2py_success) of w_mu*/
    /* End of cleaning variable w_mu */
    /* End of cleaning variable f_munu */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of get_fmunu ******************************/

/*************************** multiply_lambda_tensor ***************************/
static char doc_f2py_rout_SCHAModules_multiply_lambda_tensor[] = "\
output_matrix = multiply_lambda_tensor(wr,pols,trans,mass,ityp,t,input_matrix,inverse,[nmodes,nat,ntyp])\n\nWrapper for ``multiply_lambda_tensor``.\
\n\nParameters\n----------\n"
"wr : input rank-1 array('d') with bounds (nmodes)\n"
"pols : input rank-2 array('d') with bounds (3 * nat,nmodes)\n"
"trans : input rank-1 array('i') with bounds (nmodes)\n"
"mass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp : input rank-1 array('i') with bounds (nat)\n"
"t : input float\n"
"input_matrix : input rank-2 array('d') with bounds (3 * nat,3 * nat)\n"
"inverse : input int\n"
"\nOther Parameters\n----------------\n"
"nmodes : input int, optional\n    Default: shape(wr, 0)\n"
"nat : input int, optional\n    Default: shape(pols, 0) / 3\n"
"ntyp : input int, optional\n    Default: shape(mass, 0)\n"
"\nReturns\n-------\n"
"output_matrix : rank-2 array('d') with bounds (3 * nat,3 * nat)";
/* extern void F_FUNC_US(multiply_lambda_tensor,MULTIPLY_LAMBDA_TENSOR)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*,double*,int*); */
static PyObject *f2py_rout_SCHAModules_multiply_lambda_tensor(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,double*,double*,int*,double*,int*,double*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int nmodes = 0;
    PyObject *nmodes_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *pols = NULL;
    npy_intp pols_Dims[2] = {-1, -1};
    const int pols_Rank = 2;
    PyArrayObject *capi_pols_tmp = NULL;
    int capi_pols_intent = 0;
    PyObject *pols_capi = Py_None;
    int *trans = NULL;
    npy_intp trans_Dims[1] = {-1};
    const int trans_Rank = 1;
    PyArrayObject *capi_trans_tmp = NULL;
    int capi_trans_intent = 0;
    PyObject *trans_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp = NULL;
    npy_intp ityp_Dims[1] = {-1};
    const int ityp_Rank = 1;
    PyArrayObject *capi_ityp_tmp = NULL;
    int capi_ityp_intent = 0;
    PyObject *ityp_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *input_matrix = NULL;
    npy_intp input_matrix_Dims[2] = {-1, -1};
    const int input_matrix_Rank = 2;
    PyArrayObject *capi_input_matrix_tmp = NULL;
    int capi_input_matrix_intent = 0;
    PyObject *input_matrix_capi = Py_None;
    double *output_matrix = NULL;
    npy_intp output_matrix_Dims[2] = {-1, -1};
    const int output_matrix_Rank = 2;
    PyArrayObject *capi_output_matrix_tmp = NULL;
    int capi_output_matrix_intent = 0;
    int inverse = 0;
    PyObject *inverse_capi = Py_None;
    static char *capi_kwlist[] = {"wr","pols","trans","mass","ityp","t","input_matrix","inverse","nmodes","nat","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OOO:SCHAModules.multiply_lambda_tensor",\
        capi_kwlist,&wr_capi,&pols_capi,&trans_capi,&mass_capi,&ityp_capi,&t_capi,&input_matrix_capi,&inverse_capi,&nmodes_capi,&nat_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable wr */
    ;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `wr' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `mass' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.multiply_lambda_tensor() 6th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable inverse */
        inverse = (int)PyObject_IsTrue(inverse_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nmodes */
    if (nmodes_capi == Py_None) nmodes = shape(wr, 0); else
        f2py_success = int_from_pyobj(&nmodes,nmodes_capi,"SCHAModules.multiply_lambda_tensor() 1st keyword (nmodes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr, 0) == nmodes,"shape(wr, 0) == nmodes","1st keyword nmodes","multiply_lambda_tensor:nmodes=%d",nmodes) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.multiply_lambda_tensor() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp,"shape(mass, 0) == ntyp","3rd keyword ntyp","multiply_lambda_tensor:ntyp=%d",ntyp) {
    /* Processing variable pols */
    pols_Dims[1]=nmodes;
    capi_pols_intent |= F2PY_INTENT_IN;
    capi_pols_tmp = array_from_pyobj(NPY_DOUBLE,pols_Dims,pols_Rank,capi_pols_intent,pols_capi);
    if (capi_pols_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `pols' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        pols = (double *)(PyArray_DATA(capi_pols_tmp));

    /* Processing variable trans */
    trans_Dims[0]=nmodes;
    capi_trans_intent |= F2PY_INTENT_IN;
    capi_trans_tmp = array_from_pyobj(NPY_INT,trans_Dims,trans_Rank,capi_trans_intent,trans_capi);
    if (capi_trans_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `trans' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        trans = (int *)(PyArray_DATA(capi_trans_tmp));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(pols, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"SCHAModules.multiply_lambda_tensor() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(pols, 0) == 3 * nat,"shape(pols, 0) == 3 * nat","2nd keyword nat","multiply_lambda_tensor:nat=%d",nat) {
    /* Processing variable ityp */
    ityp_Dims[0]=nat;
    capi_ityp_intent |= F2PY_INTENT_IN;
    capi_ityp_tmp = array_from_pyobj(NPY_INT,ityp_Dims,ityp_Rank,capi_ityp_intent,ityp_capi);
    if (capi_ityp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `ityp' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp = (int *)(PyArray_DATA(capi_ityp_tmp));

    /* Processing variable input_matrix */
    input_matrix_Dims[0]=3 * nat,input_matrix_Dims[1]=3 * nat;
    capi_input_matrix_intent |= F2PY_INTENT_IN;
    capi_input_matrix_tmp = array_from_pyobj(NPY_DOUBLE,input_matrix_Dims,input_matrix_Rank,capi_input_matrix_intent,input_matrix_capi);
    if (capi_input_matrix_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `input_matrix' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        input_matrix = (double *)(PyArray_DATA(capi_input_matrix_tmp));

    /* Processing variable output_matrix */
    output_matrix_Dims[0]=3 * nat,output_matrix_Dims[1]=3 * nat;
    capi_output_matrix_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_output_matrix_tmp = array_from_pyobj(NPY_DOUBLE,output_matrix_Dims,output_matrix_Rank,capi_output_matrix_intent,Py_None);
    if (capi_output_matrix_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `output_matrix' of SCHAModules.multiply_lambda_tensor to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        output_matrix = (double *)(PyArray_DATA(capi_output_matrix_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&nmodes,&nat,&ntyp,wr,pols,trans,mass,ityp,&t,input_matrix,output_matrix,&inverse);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_output_matrix_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_output_matrix_tmp == NULL) ... else of output_matrix*/
    /* End of cleaning variable output_matrix */
    if((PyObject *)capi_input_matrix_tmp!=input_matrix_capi) {
        Py_XDECREF(capi_input_matrix_tmp); }
    }  /*if (capi_input_matrix_tmp == NULL) ... else of input_matrix*/
    /* End of cleaning variable input_matrix */
    if((PyObject *)capi_ityp_tmp!=ityp_capi) {
        Py_XDECREF(capi_ityp_tmp); }
    }  /*if (capi_ityp_tmp == NULL) ... else of ityp*/
    /* End of cleaning variable ityp */
    } /*CHECKSCALAR(shape(pols, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_trans_tmp!=trans_capi) {
        Py_XDECREF(capi_trans_tmp); }
    }  /*if (capi_trans_tmp == NULL) ... else of trans*/
    /* End of cleaning variable trans */
    if((PyObject *)capi_pols_tmp!=pols_capi) {
        Py_XDECREF(capi_pols_tmp); }
    }  /*if (capi_pols_tmp == NULL) ... else of pols*/
    /* End of cleaning variable pols */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(wr, 0) == nmodes)*/
    } /*if (f2py_success) of nmodes*/
    /* End of cleaning variable nmodes */
    } /*if (f2py_success) of inverse*/
    /* End of cleaning variable inverse */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*********************** end of multiply_lambda_tensor ***********************/

/********************************* cell_force *********************************/
static char doc_f2py_rout_SCHAModules_cell_force[] = "\
fcell = cell_force(ainv,stress,omega,press,[wmassin])\n\nWrapper for ``cell_force``.\
\n\nParameters\n----------\n"
"ainv : input rank-2 array('d') with bounds (3,3)\n"
"stress : input rank-2 array('d') with bounds (3,3)\n"
"omega : input float\n"
"press : input float\n"
"\nOther Parameters\n----------------\n"
"wmassin : input float\n"
"\nReturns\n-------\n"
"fcell : rank-2 array('d') with bounds (3,3)";
/* extern void F_FUNC_US(cell_force,CELL_FORCE)(double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout_SCHAModules_cell_force(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *fcell = NULL;
    npy_intp fcell_Dims[2] = {-1, -1};
    const int fcell_Rank = 2;
    PyArrayObject *capi_fcell_tmp = NULL;
    int capi_fcell_intent = 0;
    double *ainv = NULL;
    npy_intp ainv_Dims[2] = {-1, -1};
    const int ainv_Rank = 2;
    PyArrayObject *capi_ainv_tmp = NULL;
    int capi_ainv_intent = 0;
    PyObject *ainv_capi = Py_None;
    double *stress = NULL;
    npy_intp stress_Dims[2] = {-1, -1};
    const int stress_Rank = 2;
    PyArrayObject *capi_stress_tmp = NULL;
    int capi_stress_intent = 0;
    PyObject *stress_capi = Py_None;
    double omega = 0;
    PyObject *omega_capi = Py_None;
    double press = 0;
    PyObject *press_capi = Py_None;
    double wmassin = 0;
    PyObject *wmassin_capi = Py_None;
    static char *capi_kwlist[] = {"ainv","stress","omega","press","wmassin",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|O:SCHAModules.cell_force",\
        capi_kwlist,&ainv_capi,&stress_capi,&omega_capi,&press_capi,&wmassin_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable fcell */
    fcell_Dims[0]=3,fcell_Dims[1]=3;
    capi_fcell_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_fcell_tmp = array_from_pyobj(NPY_DOUBLE,fcell_Dims,fcell_Rank,capi_fcell_intent,Py_None);
    if (capi_fcell_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `fcell' of SCHAModules.cell_force to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        fcell = (double *)(PyArray_DATA(capi_fcell_tmp));

    /* Processing variable stress */
    stress_Dims[0]=3,stress_Dims[1]=3;
    capi_stress_intent |= F2PY_INTENT_IN;
    capi_stress_tmp = array_from_pyobj(NPY_DOUBLE,stress_Dims,stress_Rank,capi_stress_intent,stress_capi);
    if (capi_stress_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `stress' of SCHAModules.cell_force to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        stress = (double *)(PyArray_DATA(capi_stress_tmp));

    /* Processing variable ainv */
    ainv_Dims[0]=3,ainv_Dims[1]=3;
    capi_ainv_intent |= F2PY_INTENT_IN;
    capi_ainv_tmp = array_from_pyobj(NPY_DOUBLE,ainv_Dims,ainv_Rank,capi_ainv_intent,ainv_capi);
    if (capi_ainv_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `ainv' of SCHAModules.cell_force to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ainv = (double *)(PyArray_DATA(capi_ainv_tmp));

    /* Processing variable omega */
        f2py_success = double_from_pyobj(&omega,omega_capi,"SCHAModules.cell_force() 3rd argument (omega) can't be converted to double");
    if (f2py_success) {
    /* Processing variable press */
        f2py_success = double_from_pyobj(&press,press_capi,"SCHAModules.cell_force() 4th argument (press) can't be converted to double");
    if (f2py_success) {
    /* Processing variable wmassin */
    if (wmassin_capi != Py_None)
        f2py_success = double_from_pyobj(&wmassin,wmassin_capi,"SCHAModules.cell_force() 1st keyword (wmassin) can't be converted to double");
    if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(fcell,ainv,stress,&omega,&press,&wmassin);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_fcell_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*if (f2py_success) of wmassin*/
    /* End of cleaning variable wmassin */
    } /*if (f2py_success) of press*/
    /* End of cleaning variable press */
    } /*if (f2py_success) of omega*/
    /* End of cleaning variable omega */
    if((PyObject *)capi_ainv_tmp!=ainv_capi) {
        Py_XDECREF(capi_ainv_tmp); }
    }  /*if (capi_ainv_tmp == NULL) ... else of ainv*/
    /* End of cleaning variable ainv */
    if((PyObject *)capi_stress_tmp!=stress_capi) {
        Py_XDECREF(capi_stress_tmp); }
    }  /*if (capi_stress_tmp == NULL) ... else of stress*/
    /* End of cleaning variable stress */
    }  /*if (capi_fcell_tmp == NULL) ... else of fcell*/
    /* End of cleaning variable fcell */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of cell_force *****************************/

/************************ get_gradient_supercell_fast ************************/
static char doc_f2py_rout_SCHAModules_get_gradient_supercell_fast[] = "\
grad,grad_err = get_gradient_supercell_fast(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,[n_random,natsc,n_modes,ntyp_sc,preconditioned])\n\nWrapper for ``get_gradient_supercell_fast``.\
\n\nParameters\n----------\n"
"rho : input rank-1 array('d') with bounds (n_random)\n"
"u_disp : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"eforces : input rank-3 array('d') with bounds (n_random,natsc,3)\n"
"wr_sc : input rank-1 array('d') with bounds (n_modes)\n"
"epols_sc : input rank-2 array('d') with bounds (3 * natsc,n_modes)\n"
"trans : input rank-1 array('i') with bounds (n_modes)\n"
"t : input float\n"
"mass : input rank-1 array('d') with bounds (ntyp_sc)\n"
"ityp_sc : input rank-1 array('i') with bounds (natsc)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"n_random : input int, optional\n    Default: shape(rho, 0)\n"
"natsc : input int, optional\n    Default: shape(u_disp, 1)\n"
"n_modes : input int, optional\n    Default: shape(wr_sc, 0)\n"
"ntyp_sc : input int, optional\n    Default: shape(mass, 0)\n"
"preconditioned : input int\n"
"\nReturns\n-------\n"
"grad : rank-2 array('d') with bounds (3 * natsc,3 * natsc)\n"
"grad_err : rank-2 array('d') with bounds (3 * natsc,3 * natsc)";
/* extern void F_FUNC_US(get_gradient_supercell_fast,GET_GRADIENT_SUPERCELL_FAST)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_gradient_supercell_fast(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,double*,double*,int*,string,double*,double*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int n_random = 0;
    PyObject *n_random_capi = Py_None;
    int natsc = 0;
    PyObject *natsc_capi = Py_None;
    int n_modes = 0;
    PyObject *n_modes_capi = Py_None;
    int ntyp_sc = 0;
    PyObject *ntyp_sc_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    double *u_disp = NULL;
    npy_intp u_disp_Dims[3] = {-1, -1, -1};
    const int u_disp_Rank = 3;
    PyArrayObject *capi_u_disp_tmp = NULL;
    int capi_u_disp_intent = 0;
    PyObject *u_disp_capi = Py_None;
    double *eforces = NULL;
    npy_intp eforces_Dims[3] = {-1, -1, -1};
    const int eforces_Rank = 3;
    PyArrayObject *capi_eforces_tmp = NULL;
    int capi_eforces_intent = 0;
    PyObject *eforces_capi = Py_None;
    double *wr_sc = NULL;
    npy_intp wr_sc_Dims[1] = {-1};
    const int wr_sc_Rank = 1;
    PyArrayObject *capi_wr_sc_tmp = NULL;
    int capi_wr_sc_intent = 0;
    PyObject *wr_sc_capi = Py_None;
    double *epols_sc = NULL;
    npy_intp epols_sc_Dims[2] = {-1, -1};
    const int epols_sc_Rank = 2;
    PyArrayObject *capi_epols_sc_tmp = NULL;
    int capi_epols_sc_intent = 0;
    PyObject *epols_sc_capi = Py_None;
    int *trans = NULL;
    npy_intp trans_Dims[1] = {-1};
    const int trans_Rank = 1;
    PyArrayObject *capi_trans_tmp = NULL;
    int capi_trans_intent = 0;
    PyObject *trans_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *grad = NULL;
    npy_intp grad_Dims[2] = {-1, -1};
    const int grad_Rank = 2;
    PyArrayObject *capi_grad_tmp = NULL;
    int capi_grad_intent = 0;
    double *grad_err = NULL;
    npy_intp grad_err_Dims[2] = {-1, -1};
    const int grad_err_Rank = 2;
    PyArrayObject *capi_grad_err_tmp = NULL;
    int capi_grad_err_intent = 0;
    int preconditioned = 0;
    PyObject *preconditioned_capi = Py_None;
    static char *capi_kwlist[] = {"rho","u_disp","eforces","wr_sc","epols_sc","trans","t","mass","ityp_sc","log_err","n_random","natsc","n_modes","ntyp_sc","preconditioned",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOO|OOOOO:SCHAModules.get_gradient_supercell_fast",\
        capi_kwlist,&rho_capi,&u_disp_capi,&eforces_capi,&wr_sc_capi,&epols_sc_capi,&trans_capi,&t_capi,&mass_capi,&ityp_sc_capi,&log_err_capi,&n_random_capi,&natsc_capi,&n_modes_capi,&ntyp_sc_capi,&preconditioned_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable rho */
    ;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `rho' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable wr_sc */
    ;
    capi_wr_sc_intent |= F2PY_INTENT_IN;
    capi_wr_sc_tmp = array_from_pyobj(NPY_DOUBLE,wr_sc_Dims,wr_sc_Rank,capi_wr_sc_intent,wr_sc_capi);
    if (capi_wr_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `wr_sc' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr_sc = (double *)(PyArray_DATA(capi_wr_sc_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_gradient_supercell_fast() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `mass' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 10th argument`log_err' of SCHAModules.get_gradient_supercell_fast to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable preconditioned */
    if (preconditioned_capi != Py_None)
        preconditioned = (int)PyObject_IsTrue(preconditioned_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable n_random */
    if (n_random_capi == Py_None) n_random = shape(rho, 0); else
        f2py_success = int_from_pyobj(&n_random,n_random_capi,"SCHAModules.get_gradient_supercell_fast() 1st keyword (n_random) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(rho, 0) == n_random,"shape(rho, 0) == n_random","1st keyword n_random","get_gradient_supercell_fast:n_random=%d",n_random) {
    /* Processing variable n_modes */
    if (n_modes_capi == Py_None) n_modes = shape(wr_sc, 0); else
        f2py_success = int_from_pyobj(&n_modes,n_modes_capi,"SCHAModules.get_gradient_supercell_fast() 3rd keyword (n_modes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr_sc, 0) == n_modes,"shape(wr_sc, 0) == n_modes","3rd keyword n_modes","get_gradient_supercell_fast:n_modes=%d",n_modes) {
    /* Processing variable ntyp_sc */
    if (ntyp_sc_capi == Py_None) ntyp_sc = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp_sc,ntyp_sc_capi,"SCHAModules.get_gradient_supercell_fast() 4th keyword (ntyp_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp_sc,"shape(mass, 0) == ntyp_sc","4th keyword ntyp_sc","get_gradient_supercell_fast:ntyp_sc=%d",ntyp_sc) {
    /* Processing variable u_disp */
    u_disp_Dims[0]=n_random,u_disp_Dims[2]=3;
    capi_u_disp_intent |= F2PY_INTENT_IN;
    capi_u_disp_tmp = array_from_pyobj(NPY_DOUBLE,u_disp_Dims,u_disp_Rank,capi_u_disp_intent,u_disp_capi);
    if (capi_u_disp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `u_disp' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u_disp = (double *)(PyArray_DATA(capi_u_disp_tmp));

    /* Processing variable trans */
    trans_Dims[0]=n_modes;
    capi_trans_intent |= F2PY_INTENT_IN;
    capi_trans_tmp = array_from_pyobj(NPY_INT,trans_Dims,trans_Rank,capi_trans_intent,trans_capi);
    if (capi_trans_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `trans' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        trans = (int *)(PyArray_DATA(capi_trans_tmp));

    /* Processing variable natsc */
    if (natsc_capi == Py_None) natsc = shape(u_disp, 1); else
        f2py_success = int_from_pyobj(&natsc,natsc_capi,"SCHAModules.get_gradient_supercell_fast() 2nd keyword (natsc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(u_disp, 1) == natsc,"shape(u_disp, 1) == natsc","2nd keyword natsc","get_gradient_supercell_fast:natsc=%d",natsc) {
    /* Processing variable eforces */
    eforces_Dims[0]=n_random,eforces_Dims[1]=natsc,eforces_Dims[2]=3;
    capi_eforces_intent |= F2PY_INTENT_IN;
    capi_eforces_tmp = array_from_pyobj(NPY_DOUBLE,eforces_Dims,eforces_Rank,capi_eforces_intent,eforces_capi);
    if (capi_eforces_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `eforces' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        eforces = (double *)(PyArray_DATA(capi_eforces_tmp));

    /* Processing variable epols_sc */
    epols_sc_Dims[0]=3 * natsc,epols_sc_Dims[1]=n_modes;
    capi_epols_sc_intent |= F2PY_INTENT_IN;
    capi_epols_sc_tmp = array_from_pyobj(NPY_DOUBLE,epols_sc_Dims,epols_sc_Rank,capi_epols_sc_intent,epols_sc_capi);
    if (capi_epols_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `epols_sc' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        epols_sc = (double *)(PyArray_DATA(capi_epols_sc_tmp));

    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=natsc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 9th argument `ityp_sc' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable grad */
    grad_Dims[0]=3 * natsc,grad_Dims[1]=3 * natsc;
    capi_grad_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_tmp = array_from_pyobj(NPY_DOUBLE,grad_Dims,grad_Rank,capi_grad_intent,Py_None);
    if (capi_grad_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad = (double *)(PyArray_DATA(capi_grad_tmp));

    /* Processing variable grad_err */
    grad_err_Dims[0]=3 * natsc,grad_err_Dims[1]=3 * natsc;
    capi_grad_err_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_grad_err_tmp = array_from_pyobj(NPY_DOUBLE,grad_err_Dims,grad_err_Rank,capi_grad_err_intent,Py_None);
    if (capi_grad_err_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `grad_err' of SCHAModules.get_gradient_supercell_fast to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        grad_err = (double *)(PyArray_DATA(capi_grad_err_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&n_random,&natsc,&n_modes,&ntyp_sc,rho,u_disp,eforces,wr_sc,epols_sc,trans,&t,mass,ityp_sc,log_err,grad,grad_err,&preconditioned,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_grad_tmp,capi_grad_err_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_grad_err_tmp == NULL) ... else of grad_err*/
    /* End of cleaning variable grad_err */
    }  /*if (capi_grad_tmp == NULL) ... else of grad*/
    /* End of cleaning variable grad */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    if((PyObject *)capi_epols_sc_tmp!=epols_sc_capi) {
        Py_XDECREF(capi_epols_sc_tmp); }
    }  /*if (capi_epols_sc_tmp == NULL) ... else of epols_sc*/
    /* End of cleaning variable epols_sc */
    if((PyObject *)capi_eforces_tmp!=eforces_capi) {
        Py_XDECREF(capi_eforces_tmp); }
    }  /*if (capi_eforces_tmp == NULL) ... else of eforces*/
    /* End of cleaning variable eforces */
    } /*CHECKSCALAR(shape(u_disp, 1) == natsc)*/
    } /*if (f2py_success) of natsc*/
    /* End of cleaning variable natsc */
    if((PyObject *)capi_trans_tmp!=trans_capi) {
        Py_XDECREF(capi_trans_tmp); }
    }  /*if (capi_trans_tmp == NULL) ... else of trans*/
    /* End of cleaning variable trans */
    if((PyObject *)capi_u_disp_tmp!=u_disp_capi) {
        Py_XDECREF(capi_u_disp_tmp); }
    }  /*if (capi_u_disp_tmp == NULL) ... else of u_disp*/
    /* End of cleaning variable u_disp */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp_sc)*/
    } /*if (f2py_success) of ntyp_sc*/
    /* End of cleaning variable ntyp_sc */
    } /*CHECKSCALAR(shape(wr_sc, 0) == n_modes)*/
    } /*if (f2py_success) of n_modes*/
    /* End of cleaning variable n_modes */
    } /*CHECKSCALAR(shape(rho, 0) == n_random)*/
    } /*if (f2py_success) of n_random*/
    /* End of cleaning variable n_random */
    } /*if (f2py_success) of preconditioned*/
    /* End of cleaning variable preconditioned */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_wr_sc_tmp!=wr_sc_capi) {
        Py_XDECREF(capi_wr_sc_tmp); }
    }  /*if (capi_wr_sc_tmp == NULL) ... else of wr_sc*/
    /* End of cleaning variable wr_sc */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************* end of get_gradient_supercell_fast *********************/

/*********************** get_unpreconditioned_gradient ***********************/
static char doc_f2py_rout_SCHAModules_get_unpreconditioned_gradient[] = "\
gradient,err_gradient = get_unpreconditioned_gradient(u,f,e_pols,w,t,mass,ityp,rho,log_err,[n,nrand,nmodes,ntyp])\n\nWrapper for ``get_unpreconditioned_gradient``.\
\n\nParameters\n----------\n"
"u : input rank-2 array('d') with bounds (n,nrand)\n"
"f : input rank-2 array('d') with bounds (n,nrand)\n"
"e_pols : input rank-2 array('d') with bounds (n,nmodes)\n"
"w : input rank-1 array('d') with bounds (nmodes)\n"
"t : input float\n"
"mass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp : input rank-1 array('i') with bounds (n / 3)\n"
"rho : input rank-1 array('d') with bounds (nrand)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(u, 0)\n"
"nrand : input int, optional\n    Default: shape(u, 1)\n"
"nmodes : input int, optional\n    Default: shape(e_pols, 1)\n"
"ntyp : input int, optional\n    Default: shape(mass, 0)\n"
"\nReturns\n-------\n"
"gradient : rank-2 array('d') with bounds (n,n)\n"
"err_gradient : rank-2 array('d') with bounds (n,n)";
/* extern void F_FUNC_US(get_unpreconditioned_gradient,GET_UNPRECONDITIONED_GRADIENT)(double*,double*,double*,double*,double*,double*,int*,double*,string,double*,double*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_unpreconditioned_gradient(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,int*,double*,string,double*,double*,int*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *u = NULL;
    npy_intp u_Dims[2] = {-1, -1};
    const int u_Rank = 2;
    PyArrayObject *capi_u_tmp = NULL;
    int capi_u_intent = 0;
    PyObject *u_capi = Py_None;
    double *f = NULL;
    npy_intp f_Dims[2] = {-1, -1};
    const int f_Rank = 2;
    PyArrayObject *capi_f_tmp = NULL;
    int capi_f_intent = 0;
    PyObject *f_capi = Py_None;
    double *e_pols = NULL;
    npy_intp e_pols_Dims[2] = {-1, -1};
    const int e_pols_Rank = 2;
    PyArrayObject *capi_e_pols_tmp = NULL;
    int capi_e_pols_intent = 0;
    PyObject *e_pols_capi = Py_None;
    double *w = NULL;
    npy_intp w_Dims[1] = {-1};
    const int w_Rank = 1;
    PyArrayObject *capi_w_tmp = NULL;
    int capi_w_intent = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int *ityp = NULL;
    npy_intp ityp_Dims[1] = {-1};
    const int ityp_Rank = 1;
    PyArrayObject *capi_ityp_tmp = NULL;
    int capi_ityp_intent = 0;
    PyObject *ityp_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *gradient = NULL;
    npy_intp gradient_Dims[2] = {-1, -1};
    const int gradient_Rank = 2;
    PyArrayObject *capi_gradient_tmp = NULL;
    int capi_gradient_intent = 0;
    double *err_gradient = NULL;
    npy_intp err_gradient_Dims[2] = {-1, -1};
    const int err_gradient_Rank = 2;
    PyArrayObject *capi_err_gradient_tmp = NULL;
    int capi_err_gradient_intent = 0;
    int n = 0;
    PyObject *n_capi = Py_None;
    int nrand = 0;
    PyObject *nrand_capi = Py_None;
    int nmodes = 0;
    PyObject *nmodes_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"u","f","e_pols","w","t","mass","ityp","rho","log_err","n","nrand","nmodes","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOOO:SCHAModules.get_unpreconditioned_gradient",\
        capi_kwlist,&u_capi,&f_capi,&e_pols_capi,&w_capi,&t_capi,&mass_capi,&ityp_capi,&rho_capi,&log_err_capi,&n_capi,&nrand_capi,&nmodes_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable u */
    ;
    capi_u_intent |= F2PY_INTENT_IN;
    capi_u_tmp = array_from_pyobj(NPY_DOUBLE,u_Dims,u_Rank,capi_u_intent,u_capi);
    if (capi_u_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `u' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u = (double *)(PyArray_DATA(capi_u_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_unpreconditioned_gradient() 5th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable mass */
    ;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `mass' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 9th argument`log_err' of SCHAModules.get_unpreconditioned_gradient to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable n */
    if (n_capi == Py_None) n = shape(u, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"SCHAModules.get_unpreconditioned_gradient() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(u, 0) == n,"shape(u, 0) == n","1st keyword n","get_unpreconditioned_gradient:n=%d",n) {
    /* Processing variable nrand */
    if (nrand_capi == Py_None) nrand = shape(u, 1); else
        f2py_success = int_from_pyobj(&nrand,nrand_capi,"SCHAModules.get_unpreconditioned_gradient() 2nd keyword (nrand) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(u, 1) == nrand,"shape(u, 1) == nrand","2nd keyword nrand","get_unpreconditioned_gradient:nrand=%d",nrand) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(mass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_unpreconditioned_gradient() 4th keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(mass, 0) == ntyp,"shape(mass, 0) == ntyp","4th keyword ntyp","get_unpreconditioned_gradient:ntyp=%d",ntyp) {
    /* Processing variable f */
    f_Dims[0]=n,f_Dims[1]=nrand;
    capi_f_intent |= F2PY_INTENT_IN;
    capi_f_tmp = array_from_pyobj(NPY_DOUBLE,f_Dims,f_Rank,capi_f_intent,f_capi);
    if (capi_f_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `f' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        f = (double *)(PyArray_DATA(capi_f_tmp));

    /* Processing variable e_pols */
    e_pols_Dims[0]=n;
    capi_e_pols_intent |= F2PY_INTENT_IN;
    capi_e_pols_tmp = array_from_pyobj(NPY_DOUBLE,e_pols_Dims,e_pols_Rank,capi_e_pols_intent,e_pols_capi);
    if (capi_e_pols_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `e_pols' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        e_pols = (double *)(PyArray_DATA(capi_e_pols_tmp));

    /* Processing variable ityp */
    ityp_Dims[0]=n / 3;
    capi_ityp_intent |= F2PY_INTENT_IN;
    capi_ityp_tmp = array_from_pyobj(NPY_INT,ityp_Dims,ityp_Rank,capi_ityp_intent,ityp_capi);
    if (capi_ityp_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `ityp' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp = (int *)(PyArray_DATA(capi_ityp_tmp));

    /* Processing variable rho */
    rho_Dims[0]=nrand;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `rho' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable gradient */
    gradient_Dims[0]=n,gradient_Dims[1]=n;
    capi_gradient_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_gradient_tmp = array_from_pyobj(NPY_DOUBLE,gradient_Dims,gradient_Rank,capi_gradient_intent,Py_None);
    if (capi_gradient_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `gradient' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        gradient = (double *)(PyArray_DATA(capi_gradient_tmp));

    /* Processing variable err_gradient */
    err_gradient_Dims[0]=n,err_gradient_Dims[1]=n;
    capi_err_gradient_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_err_gradient_tmp = array_from_pyobj(NPY_DOUBLE,err_gradient_Dims,err_gradient_Rank,capi_err_gradient_intent,Py_None);
    if (capi_err_gradient_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `err_gradient' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        err_gradient = (double *)(PyArray_DATA(capi_err_gradient_tmp));

    /* Processing variable nmodes */
    if (nmodes_capi == Py_None) nmodes = shape(e_pols, 1); else
        f2py_success = int_from_pyobj(&nmodes,nmodes_capi,"SCHAModules.get_unpreconditioned_gradient() 3rd keyword (nmodes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(e_pols, 1) == nmodes,"shape(e_pols, 1) == nmodes","3rd keyword nmodes","get_unpreconditioned_gradient:nmodes=%d",nmodes) {
    /* Processing variable w */
    w_Dims[0]=nmodes;
    capi_w_intent |= F2PY_INTENT_IN;
    capi_w_tmp = array_from_pyobj(NPY_DOUBLE,w_Dims,w_Rank,capi_w_intent,w_capi);
    if (capi_w_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `w' of SCHAModules.get_unpreconditioned_gradient to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        w = (double *)(PyArray_DATA(capi_w_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(u,f,e_pols,w,&t,mass,ityp,rho,log_err,gradient,err_gradient,&n,&nrand,&nmodes,&ntyp,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_gradient_tmp,capi_err_gradient_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_w_tmp!=w_capi) {
        Py_XDECREF(capi_w_tmp); }
    }  /*if (capi_w_tmp == NULL) ... else of w*/
    /* End of cleaning variable w */
    } /*CHECKSCALAR(shape(e_pols, 1) == nmodes)*/
    } /*if (f2py_success) of nmodes*/
    /* End of cleaning variable nmodes */
    }  /*if (capi_err_gradient_tmp == NULL) ... else of err_gradient*/
    /* End of cleaning variable err_gradient */
    }  /*if (capi_gradient_tmp == NULL) ... else of gradient*/
    /* End of cleaning variable gradient */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_ityp_tmp!=ityp_capi) {
        Py_XDECREF(capi_ityp_tmp); }
    }  /*if (capi_ityp_tmp == NULL) ... else of ityp*/
    /* End of cleaning variable ityp */
    if((PyObject *)capi_e_pols_tmp!=e_pols_capi) {
        Py_XDECREF(capi_e_pols_tmp); }
    }  /*if (capi_e_pols_tmp == NULL) ... else of e_pols*/
    /* End of cleaning variable e_pols */
    if((PyObject *)capi_f_tmp!=f_capi) {
        Py_XDECREF(capi_f_tmp); }
    }  /*if (capi_f_tmp == NULL) ... else of f*/
    /* End of cleaning variable f */
    } /*CHECKSCALAR(shape(mass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(u, 1) == nrand)*/
    } /*if (f2py_success) of nrand*/
    /* End of cleaning variable nrand */
    } /*CHECKSCALAR(shape(u, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_u_tmp!=u_capi) {
        Py_XDECREF(capi_u_tmp); }
    }  /*if (capi_u_tmp == NULL) ... else of u*/
    /* End of cleaning variable u */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************** end of get_unpreconditioned_gradient ********************/

/********************************** get_ymu **********************************/
static char doc_f2py_rout_SCHAModules_get_ymu[] = "\
y_mu = get_ymu(w,t)\n\nWrapper for ``get_ymu``.\
\n\nParameters\n----------\n"
"w : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"y_mu : float";
/* extern void F_FUNC_US(get_ymu,GET_YMU)(double*,double*,double*); */
static PyObject *f2py_rout_SCHAModules_get_ymu(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double w = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double y_mu = 0;
    static char *capi_kwlist[] = {"w","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:SCHAModules.get_ymu",\
        capi_kwlist,&w_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable y_mu */
    /* Processing variable w */
        f2py_success = double_from_pyobj(&w,w_capi,"SCHAModules.get_ymu() 1st argument (w) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_ymu() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&w,&t,&y_mu);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",y_mu);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of w*/
    /* End of cleaning variable w */
    /* End of cleaning variable y_mu */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of get_ymu *******************************/

/*********************************** get_g ***********************************/
static char doc_f2py_rout_SCHAModules_get_g[] = "\
g = get_g(a,wr,transmode,t,[n_mode])\n\nWrapper for ``get_g``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"wr : input rank-1 array('d') with bounds (n_mode)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"t : input float\n"
"\nOther Parameters\n----------------\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"\nReturns\n-------\n"
"g : rank-2 array('d') with bounds (n_mode,n_mode)";
/* extern void F_FUNC_US(get_g,GET_G)(double*,double*,int*,double*,double*,int*); */
static PyObject *f2py_rout_SCHAModules_get_g(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *g = NULL;
    npy_intp g_Dims[2] = {-1, -1};
    const int g_Rank = 2;
    PyArrayObject *capi_g_tmp = NULL;
    int capi_g_intent = 0;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    static char *capi_kwlist[] = {"a","wr","transmode","t","n_mode",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|O:SCHAModules.get_g",\
        capi_kwlist,&a_capi,&wr_capi,&transmode_capi,&t_capi,&n_mode_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_g to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_g() 4th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_g() 1st keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","1st keyword n_mode","get_g:n_mode=%d",n_mode) {
    /* Processing variable wr */
    wr_Dims[0]=n_mode;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `wr' of SCHAModules.get_g to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `transmode' of SCHAModules.get_g to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable g */
    g_Dims[0]=n_mode,g_Dims[1]=n_mode;
    capi_g_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_g_tmp = array_from_pyobj(NPY_DOUBLE,g_Dims,g_Rank,capi_g_intent,Py_None);
    if (capi_g_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `g' of SCHAModules.get_g to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        g = (double *)(PyArray_DATA(capi_g_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,wr,transmode,&t,g,&n_mode);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_g_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_g_tmp == NULL) ... else of g*/
    /* End of cleaning variable g */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************** end of get_g ********************************/

/********************************** get_emat **********************************/
static char doc_f2py_rout_SCHAModules_get_emat[] = "\
e = get_emat(er,a,amass,ityp_sc,v3_log,transmode,[n_mode,nat_sc,ntyp])\n\nWrapper for ``get_emat``.\
\n\nParameters\n----------\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"v3_log : input int\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"\nOther Parameters\n----------------\n"
"n_mode : input int, optional\n    Default: shape(er, 1)\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"e : rank-2 array('d') with bounds (n_mode,3 * nat_sc)";
/* extern void F_FUNC_US(get_emat,GET_EMAT)(double*,double*,double*,int*,int*,int*,double*,int*,int*,int*); */
static PyObject *f2py_rout_SCHAModules_get_emat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    int v3_log = 0;
    PyObject *v3_log_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *e = NULL;
    npy_intp e_Dims[2] = {-1, -1};
    const int e_Rank = 2;
    PyArrayObject *capi_e_tmp = NULL;
    int capi_e_intent = 0;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"er","a","amass","ityp_sc","v3_log","transmode","n_mode","nat_sc","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OOO:SCHAModules.get_emat",\
        capi_kwlist,&er_capi,&a_capi,&amass_capi,&ityp_sc_capi,&v3_log_capi,&transmode_capi,&n_mode_capi,&nat_sc_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable er */
    er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `er' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `amass' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable v3_log */
        v3_log = (int)PyObject_IsTrue(v3_log_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_emat() 2nd keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","2nd keyword nat_sc","get_emat:nat_sc=%d",nat_sc) {
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(er, 1); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_emat() 1st keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 1) == n_mode,"shape(er, 1) == n_mode","1st keyword n_mode","get_emat:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_emat() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","3rd keyword ntyp","get_emat:ntyp=%d",ntyp) {
    /* Processing variable a */
    a_Dims[0]=n_mode;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `a' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `ityp_sc' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `transmode' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable e */
    e_Dims[0]=n_mode,e_Dims[1]=3 * nat_sc;
    capi_e_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_e_tmp = array_from_pyobj(NPY_DOUBLE,e_Dims,e_Rank,capi_e_intent,Py_None);
    if (capi_e_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `e' of SCHAModules.get_emat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        e = (double *)(PyArray_DATA(capi_e_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(er,a,amass,ityp_sc,&v3_log,transmode,e,&n_mode,&nat_sc,&ntyp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_e_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_e_tmp == NULL) ... else of e*/
    /* End of cleaning variable e */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(er, 1) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    } /*if (f2py_success) of v3_log*/
    /* End of cleaning variable v3_log */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of get_emat ******************************/

/*********************************** get_v3 ***********************************/
static char doc_f2py_rout_SCHAModules_get_v3[] = "\
v3 = get_v3(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,[nat_sc,n_mode,n_random,ntyp])\n\nWrapper for ``get_v3``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"f : input rank-3 array('d') with bounds (n_random,nat_sc,3)\n"
"u : input rank-3 array('d') with bounds (n_random,nat_sc,3)\n"
"rho : input rank-1 array('d') with bounds (n_random)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"n_random : input int, optional\n    Default: shape(f, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"v3 : rank-3 array('d') with bounds (n_mode,n_mode,n_mode)";
/* extern void F_FUNC_US(get_v3,GET_V3)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_v3(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    double *f = NULL;
    npy_intp f_Dims[3] = {-1, -1, -1};
    const int f_Rank = 3;
    PyArrayObject *capi_f_tmp = NULL;
    int capi_f_intent = 0;
    PyObject *f_capi = Py_None;
    double *u = NULL;
    npy_intp u_Dims[3] = {-1, -1, -1};
    const int u_Rank = 3;
    PyArrayObject *capi_u_tmp = NULL;
    int capi_u_intent = 0;
    PyObject *u_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *v3 = NULL;
    npy_intp v3_Dims[3] = {-1, -1, -1};
    const int v3_Rank = 3;
    PyArrayObject *capi_v3_tmp = NULL;
    int capi_v3_intent = 0;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int n_random = 0;
    PyObject *n_random_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"a","er","transmode","amass","ityp_sc","f","u","rho","log_err","nat_sc","n_mode","n_random","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOOO:SCHAModules.get_v3",\
        capi_kwlist,&a_capi,&er_capi,&transmode_capi,&amass_capi,&ityp_sc_capi,&f_capi,&u_capi,&rho_capi,&log_err_capi,&nat_sc_capi,&n_mode_capi,&n_random_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `amass' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 9th argument`log_err' of SCHAModules.get_v3 to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_v3() 2nd keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","2nd keyword n_mode","get_v3:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_v3() 4th keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","4th keyword ntyp","get_v3:ntyp=%d",ntyp) {
    /* Processing variable er */
    er_Dims[1]=n_mode,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `er' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `transmode' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable v3 */
    v3_Dims[0]=n_mode,v3_Dims[1]=n_mode,v3_Dims[2]=n_mode;
    capi_v3_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_v3_tmp = array_from_pyobj(NPY_DOUBLE,v3_Dims,v3_Rank,capi_v3_intent,Py_None);
    if (capi_v3_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `v3' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v3 = (double *)(PyArray_DATA(capi_v3_tmp));

    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_v3() 1st keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","1st keyword nat_sc","get_v3:nat_sc=%d",nat_sc) {
    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `ityp_sc' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable f */
    f_Dims[1]=nat_sc,f_Dims[2]=3;
    capi_f_intent |= F2PY_INTENT_IN;
    capi_f_tmp = array_from_pyobj(NPY_DOUBLE,f_Dims,f_Rank,capi_f_intent,f_capi);
    if (capi_f_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `f' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        f = (double *)(PyArray_DATA(capi_f_tmp));

    /* Processing variable n_random */
    if (n_random_capi == Py_None) n_random = shape(f, 0); else
        f2py_success = int_from_pyobj(&n_random,n_random_capi,"SCHAModules.get_v3() 3rd keyword (n_random) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(f, 0) == n_random,"shape(f, 0) == n_random","3rd keyword n_random","get_v3:n_random=%d",n_random) {
    /* Processing variable u */
    u_Dims[0]=n_random,u_Dims[1]=nat_sc,u_Dims[2]=3;
    capi_u_intent |= F2PY_INTENT_IN;
    capi_u_tmp = array_from_pyobj(NPY_DOUBLE,u_Dims,u_Rank,capi_u_intent,u_capi);
    if (capi_u_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `u' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u = (double *)(PyArray_DATA(capi_u_tmp));

    /* Processing variable rho */
    rho_Dims[0]=n_random;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `rho' of SCHAModules.get_v3 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,v3,&nat_sc,&n_mode,&n_random,&ntyp,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_v3_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_u_tmp!=u_capi) {
        Py_XDECREF(capi_u_tmp); }
    }  /*if (capi_u_tmp == NULL) ... else of u*/
    /* End of cleaning variable u */
    } /*CHECKSCALAR(shape(f, 0) == n_random)*/
    } /*if (f2py_success) of n_random*/
    /* End of cleaning variable n_random */
    if((PyObject *)capi_f_tmp!=f_capi) {
        Py_XDECREF(capi_f_tmp); }
    }  /*if (capi_f_tmp == NULL) ... else of f*/
    /* End of cleaning variable f */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    }  /*if (capi_v3_tmp == NULL) ... else of v3*/
    /* End of cleaning variable v3 */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of get_v3 *******************************/

/****************************** get_odd_straight ******************************/
static char doc_f2py_rout_SCHAModules_get_odd_straight[] = "\
phi_sc_odd = get_odd_straight(a,wr,er,transmode,amass,ityp_sc,t,v3,[n_mode,nat_sc,ntyp])\n\nWrapper for ``get_odd_straight``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"wr : input rank-1 array('d') with bounds (n_mode)\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"t : input float\n"
"v3 : input rank-3 array('d') with bounds (n_mode,n_mode,n_mode)\n"
"\nOther Parameters\n----------------\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"phi_sc_odd : rank-2 array('d') with bounds (n_mode,n_mode)";
/* extern void F_FUNC_US(get_odd_straight,GET_ODD_STRAIGHT)(double*,double*,double*,int*,double*,int*,double*,double*,double*,int*,int*,int*); */
static PyObject *f2py_rout_SCHAModules_get_odd_straight(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,double*,int*,double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *v3 = NULL;
    npy_intp v3_Dims[3] = {-1, -1, -1};
    const int v3_Rank = 3;
    PyArrayObject *capi_v3_tmp = NULL;
    int capi_v3_intent = 0;
    PyObject *v3_capi = Py_None;
    double *phi_sc_odd = NULL;
    npy_intp phi_sc_odd_Dims[2] = {-1, -1};
    const int phi_sc_odd_Rank = 2;
    PyArrayObject *capi_phi_sc_odd_tmp = NULL;
    int capi_phi_sc_odd_intent = 0;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"a","wr","er","transmode","amass","ityp_sc","t","v3","n_mode","nat_sc","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OOO:SCHAModules.get_odd_straight",\
        capi_kwlist,&a_capi,&wr_capi,&er_capi,&transmode_capi,&amass_capi,&ityp_sc_capi,&t_capi,&v3_capi,&n_mode_capi,&nat_sc_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `amass' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_odd_straight() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_odd_straight() 1st keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","1st keyword n_mode","get_odd_straight:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_odd_straight() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","3rd keyword ntyp","get_odd_straight:ntyp=%d",ntyp) {
    /* Processing variable wr */
    wr_Dims[0]=n_mode;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `wr' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable er */
    er_Dims[1]=n_mode,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `er' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `transmode' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable v3 */
    v3_Dims[0]=n_mode,v3_Dims[1]=n_mode,v3_Dims[2]=n_mode;
    capi_v3_intent |= F2PY_INTENT_IN;
    capi_v3_tmp = array_from_pyobj(NPY_DOUBLE,v3_Dims,v3_Rank,capi_v3_intent,v3_capi);
    if (capi_v3_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `v3' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v3 = (double *)(PyArray_DATA(capi_v3_tmp));

    /* Processing variable phi_sc_odd */
    phi_sc_odd_Dims[0]=n_mode,phi_sc_odd_Dims[1]=n_mode;
    capi_phi_sc_odd_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_phi_sc_odd_tmp = array_from_pyobj(NPY_DOUBLE,phi_sc_odd_Dims,phi_sc_odd_Rank,capi_phi_sc_odd_intent,Py_None);
    if (capi_phi_sc_odd_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `phi_sc_odd' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        phi_sc_odd = (double *)(PyArray_DATA(capi_phi_sc_odd_tmp));

    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_odd_straight() 2nd keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","2nd keyword nat_sc","get_odd_straight:nat_sc=%d",nat_sc) {
    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `ityp_sc' of SCHAModules.get_odd_straight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,wr,er,transmode,amass,ityp_sc,&t,v3,phi_sc_odd,&n_mode,&nat_sc,&ntyp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_phi_sc_odd_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    }  /*if (capi_phi_sc_odd_tmp == NULL) ... else of phi_sc_odd*/
    /* End of cleaning variable phi_sc_odd */
    if((PyObject *)capi_v3_tmp!=v3_capi) {
        Py_XDECREF(capi_v3_tmp); }
    }  /*if (capi_v3_tmp == NULL) ... else of v3*/
    /* End of cleaning variable v3 */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of get_odd_straight **************************/

/********************************** get_cmat **********************************/
static char doc_f2py_rout_SCHAModules_get_cmat[] = "\
cmat = get_cmat(a,wr,er,transmode,amass,ityp_sc,t,v3_log,[n_mode,nat_sc,ntyp])\n\nWrapper for ``get_cmat``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"wr : input rank-1 array('d') with bounds (n_mode)\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"t : input float\n"
"v3_log : input int\n"
"\nOther Parameters\n----------------\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"cmat : rank-2 array('d') with bounds (n_mode * n_mode,n_mode * n_mode)";
/* extern void F_FUNC_US(get_cmat,GET_CMAT)(double*,double*,double*,int*,double*,int*,double*,int*,double*,int*,int*,int*); */
static PyObject *f2py_rout_SCHAModules_get_cmat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,double*,int*,double*,int*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int v3_log = 0;
    PyObject *v3_log_capi = Py_None;
    double *cmat = NULL;
    npy_intp cmat_Dims[2] = {-1, -1};
    const int cmat_Rank = 2;
    PyArrayObject *capi_cmat_tmp = NULL;
    int capi_cmat_intent = 0;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"a","wr","er","transmode","amass","ityp_sc","t","v3_log","n_mode","nat_sc","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OOO:SCHAModules.get_cmat",\
        capi_kwlist,&a_capi,&wr_capi,&er_capi,&transmode_capi,&amass_capi,&ityp_sc_capi,&t_capi,&v3_log_capi,&n_mode_capi,&nat_sc_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `amass' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_cmat() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable v3_log */
        v3_log = (int)PyObject_IsTrue(v3_log_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_cmat() 1st keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","1st keyword n_mode","get_cmat:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_cmat() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","3rd keyword ntyp","get_cmat:ntyp=%d",ntyp) {
    /* Processing variable wr */
    wr_Dims[0]=n_mode;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `wr' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable er */
    er_Dims[1]=n_mode,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `er' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `transmode' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable cmat */
    cmat_Dims[0]=n_mode * n_mode,cmat_Dims[1]=n_mode * n_mode;
    capi_cmat_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_cmat_tmp = array_from_pyobj(NPY_DOUBLE,cmat_Dims,cmat_Rank,capi_cmat_intent,Py_None);
    if (capi_cmat_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `cmat' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        cmat = (double *)(PyArray_DATA(capi_cmat_tmp));

    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_cmat() 2nd keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","2nd keyword nat_sc","get_cmat:nat_sc=%d",nat_sc) {
    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `ityp_sc' of SCHAModules.get_cmat to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,wr,er,transmode,amass,ityp_sc,&t,&v3_log,cmat,&n_mode,&nat_sc,&ntyp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_cmat_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    }  /*if (capi_cmat_tmp == NULL) ... else of cmat*/
    /* End of cleaning variable cmat */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
    } /*if (f2py_success) of v3_log*/
    /* End of cleaning variable v3_log */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of get_cmat ******************************/

/*********************************** get_v4 ***********************************/
static char doc_f2py_rout_SCHAModules_get_v4[] = "\
v4 = get_v4(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,[nat_sc,n_mode,n_random,ntyp])\n\nWrapper for ``get_v4``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"f : input rank-3 array('d') with bounds (n_random,nat_sc,3)\n"
"u : input rank-3 array('d') with bounds (n_random,nat_sc,3)\n"
"rho : input rank-1 array('d') with bounds (n_random)\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"n_random : input int, optional\n    Default: shape(f, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"v4 : rank-4 array('d') with bounds (n_mode,n_mode,n_mode,n_mode)";
/* extern void F_FUNC_US(get_v4,GET_V4)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout_SCHAModules_get_v4(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,double*,int*,double*,double*,double*,string,double*,int*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    double *f = NULL;
    npy_intp f_Dims[3] = {-1, -1, -1};
    const int f_Rank = 3;
    PyArrayObject *capi_f_tmp = NULL;
    int capi_f_intent = 0;
    PyObject *f_capi = Py_None;
    double *u = NULL;
    npy_intp u_Dims[3] = {-1, -1, -1};
    const int u_Rank = 3;
    PyArrayObject *capi_u_tmp = NULL;
    int capi_u_intent = 0;
    PyObject *u_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double *v4 = NULL;
    npy_intp v4_Dims[4] = {-1, -1, -1, -1};
    const int v4_Rank = 4;
    PyArrayObject *capi_v4_tmp = NULL;
    int capi_v4_intent = 0;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int n_random = 0;
    PyObject *n_random_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"a","er","transmode","amass","ityp_sc","f","u","rho","log_err","nat_sc","n_mode","n_random","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOOO:SCHAModules.get_v4",\
        capi_kwlist,&a_capi,&er_capi,&transmode_capi,&amass_capi,&ityp_sc_capi,&f_capi,&u_capi,&rho_capi,&log_err_capi,&nat_sc_capi,&n_mode_capi,&n_random_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `amass' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 9th argument`log_err' of SCHAModules.get_v4 to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_v4() 2nd keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","2nd keyword n_mode","get_v4:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_v4() 4th keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","4th keyword ntyp","get_v4:ntyp=%d",ntyp) {
    /* Processing variable er */
    er_Dims[1]=n_mode,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `er' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `transmode' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable v4 */
    v4_Dims[0]=n_mode,v4_Dims[1]=n_mode,v4_Dims[2]=n_mode,v4_Dims[3]=n_mode;
    capi_v4_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_v4_tmp = array_from_pyobj(NPY_DOUBLE,v4_Dims,v4_Rank,capi_v4_intent,Py_None);
    if (capi_v4_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `v4' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v4 = (double *)(PyArray_DATA(capi_v4_tmp));

    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_v4() 1st keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","1st keyword nat_sc","get_v4:nat_sc=%d",nat_sc) {
    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `ityp_sc' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

    /* Processing variable f */
    f_Dims[1]=nat_sc,f_Dims[2]=3;
    capi_f_intent |= F2PY_INTENT_IN;
    capi_f_tmp = array_from_pyobj(NPY_DOUBLE,f_Dims,f_Rank,capi_f_intent,f_capi);
    if (capi_f_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `f' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        f = (double *)(PyArray_DATA(capi_f_tmp));

    /* Processing variable n_random */
    if (n_random_capi == Py_None) n_random = shape(f, 0); else
        f2py_success = int_from_pyobj(&n_random,n_random_capi,"SCHAModules.get_v4() 3rd keyword (n_random) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(f, 0) == n_random,"shape(f, 0) == n_random","3rd keyword n_random","get_v4:n_random=%d",n_random) {
    /* Processing variable u */
    u_Dims[0]=n_random,u_Dims[1]=nat_sc,u_Dims[2]=3;
    capi_u_intent |= F2PY_INTENT_IN;
    capi_u_tmp = array_from_pyobj(NPY_DOUBLE,u_Dims,u_Rank,capi_u_intent,u_capi);
    if (capi_u_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `u' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        u = (double *)(PyArray_DATA(capi_u_tmp));

    /* Processing variable rho */
    rho_Dims[0]=n_random;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `rho' of SCHAModules.get_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,v4,&nat_sc,&n_mode,&n_random,&ntyp,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_v4_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_u_tmp!=u_capi) {
        Py_XDECREF(capi_u_tmp); }
    }  /*if (capi_u_tmp == NULL) ... else of u*/
    /* End of cleaning variable u */
    } /*CHECKSCALAR(shape(f, 0) == n_random)*/
    } /*if (f2py_success) of n_random*/
    /* End of cleaning variable n_random */
    if((PyObject *)capi_f_tmp!=f_capi) {
        Py_XDECREF(capi_f_tmp); }
    }  /*if (capi_f_tmp == NULL) ... else of f*/
    /* End of cleaning variable f */
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    }  /*if (capi_v4_tmp == NULL) ... else of v4*/
    /* End of cleaning variable v4 */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of get_v4 *******************************/

/************************** get_odd_straight_with_v4 **************************/
static char doc_f2py_rout_SCHAModules_get_odd_straight_with_v4[] = "\
phi_sc_odd = get_odd_straight_with_v4(a,wr,er,transmode,amass,ityp_sc,t,v3,v4,[n_mode,nat_sc,ntyp])\n\nWrapper for ``get_odd_straight_with_v4``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('d') with bounds (n_mode)\n"
"wr : input rank-1 array('d') with bounds (n_mode)\n"
"er : input rank-3 array('d') with bounds (nat_sc,n_mode,3)\n"
"transmode : input rank-1 array('i') with bounds (n_mode)\n"
"amass : input rank-1 array('d') with bounds (ntyp)\n"
"ityp_sc : input rank-1 array('i') with bounds (nat_sc)\n"
"t : input float\n"
"v3 : input rank-3 array('d') with bounds (n_mode,n_mode,n_mode)\n"
"v4 : input rank-4 array('d') with bounds (n_mode,n_mode,n_mode,n_mode)\n"
"\nOther Parameters\n----------------\n"
"n_mode : input int, optional\n    Default: shape(a, 0)\n"
"nat_sc : input int, optional\n    Default: shape(er, 0)\n"
"ntyp : input int, optional\n    Default: shape(amass, 0)\n"
"\nReturns\n-------\n"
"phi_sc_odd : rank-2 array('d') with bounds (n_mode,n_mode)";
/* extern void F_FUNC_US(get_odd_straight_with_v4,GET_ODD_STRAIGHT_WITH_V4)(double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,int*,int*,int*); */
static PyObject *f2py_rout_SCHAModules_get_odd_straight_with_v4(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[3] = {-1, -1, -1};
    const int er_Rank = 3;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    int *transmode = NULL;
    npy_intp transmode_Dims[1] = {-1};
    const int transmode_Rank = 1;
    PyArrayObject *capi_transmode_tmp = NULL;
    int capi_transmode_intent = 0;
    PyObject *transmode_capi = Py_None;
    double *amass = NULL;
    npy_intp amass_Dims[1] = {-1};
    const int amass_Rank = 1;
    PyArrayObject *capi_amass_tmp = NULL;
    int capi_amass_intent = 0;
    PyObject *amass_capi = Py_None;
    int *ityp_sc = NULL;
    npy_intp ityp_sc_Dims[1] = {-1};
    const int ityp_sc_Rank = 1;
    PyArrayObject *capi_ityp_sc_tmp = NULL;
    int capi_ityp_sc_intent = 0;
    PyObject *ityp_sc_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *v3 = NULL;
    npy_intp v3_Dims[3] = {-1, -1, -1};
    const int v3_Rank = 3;
    PyArrayObject *capi_v3_tmp = NULL;
    int capi_v3_intent = 0;
    PyObject *v3_capi = Py_None;
    double *v4 = NULL;
    npy_intp v4_Dims[4] = {-1, -1, -1, -1};
    const int v4_Rank = 4;
    PyArrayObject *capi_v4_tmp = NULL;
    int capi_v4_intent = 0;
    PyObject *v4_capi = Py_None;
    double *phi_sc_odd = NULL;
    npy_intp phi_sc_odd_Dims[2] = {-1, -1};
    const int phi_sc_odd_Rank = 2;
    PyArrayObject *capi_phi_sc_odd_tmp = NULL;
    int capi_phi_sc_odd_intent = 0;
    int n_mode = 0;
    PyObject *n_mode_capi = Py_None;
    int nat_sc = 0;
    PyObject *nat_sc_capi = Py_None;
    int ntyp = 0;
    PyObject *ntyp_capi = Py_None;
    static char *capi_kwlist[] = {"a","wr","er","transmode","amass","ityp_sc","t","v3","v4","n_mode","nat_sc","ntyp",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOO:SCHAModules.get_odd_straight_with_v4",\
        capi_kwlist,&a_capi,&wr_capi,&er_capi,&transmode_capi,&amass_capi,&ityp_sc_capi,&t_capi,&v3_capi,&v4_capi,&n_mode_capi,&nat_sc_capi,&ntyp_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `a' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable amass */
    ;
    capi_amass_intent |= F2PY_INTENT_IN;
    capi_amass_tmp = array_from_pyobj(NPY_DOUBLE,amass_Dims,amass_Rank,capi_amass_intent,amass_capi);
    if (capi_amass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `amass' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        amass = (double *)(PyArray_DATA(capi_amass_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.get_odd_straight_with_v4() 7th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable n_mode */
    if (n_mode_capi == Py_None) n_mode = shape(a, 0); else
        f2py_success = int_from_pyobj(&n_mode,n_mode_capi,"SCHAModules.get_odd_straight_with_v4() 1st keyword (n_mode) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == n_mode,"shape(a, 0) == n_mode","1st keyword n_mode","get_odd_straight_with_v4:n_mode=%d",n_mode) {
    /* Processing variable ntyp */
    if (ntyp_capi == Py_None) ntyp = shape(amass, 0); else
        f2py_success = int_from_pyobj(&ntyp,ntyp_capi,"SCHAModules.get_odd_straight_with_v4() 3rd keyword (ntyp) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(amass, 0) == ntyp,"shape(amass, 0) == ntyp","3rd keyword ntyp","get_odd_straight_with_v4:ntyp=%d",ntyp) {
    /* Processing variable wr */
    wr_Dims[0]=n_mode;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `wr' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable er */
    er_Dims[1]=n_mode,er_Dims[2]=3;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `er' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable transmode */
    transmode_Dims[0]=n_mode;
    capi_transmode_intent |= F2PY_INTENT_IN;
    capi_transmode_tmp = array_from_pyobj(NPY_INT,transmode_Dims,transmode_Rank,capi_transmode_intent,transmode_capi);
    if (capi_transmode_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `transmode' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        transmode = (int *)(PyArray_DATA(capi_transmode_tmp));

    /* Processing variable v3 */
    v3_Dims[0]=n_mode,v3_Dims[1]=n_mode,v3_Dims[2]=n_mode;
    capi_v3_intent |= F2PY_INTENT_IN;
    capi_v3_tmp = array_from_pyobj(NPY_DOUBLE,v3_Dims,v3_Rank,capi_v3_intent,v3_capi);
    if (capi_v3_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 8th argument `v3' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v3 = (double *)(PyArray_DATA(capi_v3_tmp));

    /* Processing variable v4 */
    v4_Dims[0]=n_mode,v4_Dims[1]=n_mode,v4_Dims[2]=n_mode,v4_Dims[3]=n_mode;
    capi_v4_intent |= F2PY_INTENT_IN;
    capi_v4_tmp = array_from_pyobj(NPY_DOUBLE,v4_Dims,v4_Rank,capi_v4_intent,v4_capi);
    if (capi_v4_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 9th argument `v4' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v4 = (double *)(PyArray_DATA(capi_v4_tmp));

    /* Processing variable phi_sc_odd */
    phi_sc_odd_Dims[0]=n_mode,phi_sc_odd_Dims[1]=n_mode;
    capi_phi_sc_odd_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_phi_sc_odd_tmp = array_from_pyobj(NPY_DOUBLE,phi_sc_odd_Dims,phi_sc_odd_Rank,capi_phi_sc_odd_intent,Py_None);
    if (capi_phi_sc_odd_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `phi_sc_odd' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        phi_sc_odd = (double *)(PyArray_DATA(capi_phi_sc_odd_tmp));

    /* Processing variable nat_sc */
    if (nat_sc_capi == Py_None) nat_sc = shape(er, 0); else
        f2py_success = int_from_pyobj(&nat_sc,nat_sc_capi,"SCHAModules.get_odd_straight_with_v4() 2nd keyword (nat_sc) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == nat_sc,"shape(er, 0) == nat_sc","2nd keyword nat_sc","get_odd_straight_with_v4:nat_sc=%d",nat_sc) {
    /* Processing variable ityp_sc */
    ityp_sc_Dims[0]=nat_sc;
    capi_ityp_sc_intent |= F2PY_INTENT_IN;
    capi_ityp_sc_tmp = array_from_pyobj(NPY_INT,ityp_sc_Dims,ityp_sc_Rank,capi_ityp_sc_intent,ityp_sc_capi);
    if (capi_ityp_sc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `ityp_sc' of SCHAModules.get_odd_straight_with_v4 to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        ityp_sc = (int *)(PyArray_DATA(capi_ityp_sc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,wr,er,transmode,amass,ityp_sc,&t,v3,v4,phi_sc_odd,&n_mode,&nat_sc,&ntyp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_phi_sc_odd_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_ityp_sc_tmp!=ityp_sc_capi) {
        Py_XDECREF(capi_ityp_sc_tmp); }
    }  /*if (capi_ityp_sc_tmp == NULL) ... else of ityp_sc*/
    /* End of cleaning variable ityp_sc */
    } /*CHECKSCALAR(shape(er, 0) == nat_sc)*/
    } /*if (f2py_success) of nat_sc*/
    /* End of cleaning variable nat_sc */
    }  /*if (capi_phi_sc_odd_tmp == NULL) ... else of phi_sc_odd*/
    /* End of cleaning variable phi_sc_odd */
    if((PyObject *)capi_v4_tmp!=v4_capi) {
        Py_XDECREF(capi_v4_tmp); }
    }  /*if (capi_v4_tmp == NULL) ... else of v4*/
    /* End of cleaning variable v4 */
    if((PyObject *)capi_v3_tmp!=v3_capi) {
        Py_XDECREF(capi_v3_tmp); }
    }  /*if (capi_v3_tmp == NULL) ... else of v3*/
    /* End of cleaning variable v3 */
    if((PyObject *)capi_transmode_tmp!=transmode_capi) {
        Py_XDECREF(capi_transmode_tmp); }
    }  /*if (capi_transmode_tmp == NULL) ... else of transmode*/
    /* End of cleaning variable transmode */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
    } /*CHECKSCALAR(shape(amass, 0) == ntyp)*/
    } /*if (f2py_success) of ntyp*/
    /* End of cleaning variable ntyp */
    } /*CHECKSCALAR(shape(a, 0) == n_mode)*/
    } /*if (f2py_success) of n_mode*/
    /* End of cleaning variable n_mode */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_amass_tmp!=amass_capi) {
        Py_XDECREF(capi_amass_tmp); }
    }  /*if (capi_amass_tmp == NULL) ... else of amass*/
    /* End of cleaning variable amass */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************** end of get_odd_straight_with_v4 **********************/

/****************************** random_gaussian ******************************/
static char doc_f2py_rout_SCHAModules_stochastic_random_gaussian[] = "\
rand = random_gaussian()\n\nWrapper for ``random_gaussian``.\
\n\nReturns\n-------\n"
"rand : float";
/*  */
static PyObject *f2py_rout_SCHAModules_stochastic_random_gaussian(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double rand = 0;
    static char *capi_kwlist[] = {NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "|:SCHAModules.stochastic.random_gaussian",\
        capi_kwlist))
        return NULL;
/*frompyobj*/
    /* Processing variable rand */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&rand);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",rand);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable rand */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of random_gaussian ***************************/

/******************************* check_gaussian *******************************/
static char doc_f2py_rout_SCHAModules_stochastic_check_gaussian[] = "\
check_gaussian(random)\n\nWrapper for ``check_gaussian``.\
\n\nParameters\n----------\n"
"random : input rank-1 array('d') with bounds (f2py_random_d0)";
/* #declfortranroutine# */
static PyObject *f2py_rout_SCHAModules_stochastic_check_gaussian(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *random = NULL;
    npy_intp random_Dims[1] = {-1};
    const int random_Rank = 1;
    PyArrayObject *capi_random_tmp = NULL;
    int capi_random_intent = 0;
    PyObject *random_capi = Py_None;
    int f2py_random_d0 = 0;
    static char *capi_kwlist[] = {"random",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:SCHAModules.stochastic.check_gaussian",\
        capi_kwlist,&random_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable random */
    ;
    capi_random_intent |= F2PY_INTENT_IN;
    capi_random_tmp = array_from_pyobj(NPY_DOUBLE,random_Dims,random_Rank,capi_random_intent,random_capi);
    if (capi_random_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `random' of SCHAModules.stochastic.check_gaussian to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        random = (double *)(PyArray_DATA(capi_random_tmp));

    /* Processing variable f2py_random_d0 */
    f2py_random_d0 = shape(random, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(random,&f2py_random_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_random_d0 */
    if((PyObject *)capi_random_tmp!=random_capi) {
        Py_XDECREF(capi_random_tmp); }
    }  /*if (capi_random_tmp == NULL) ... else of random*/
    /* End of cleaning variable random */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of check_gaussian ***************************/

/**************************** get_gaussian_weight ****************************/
static char doc_f2py_rout_SCHAModules_stochastic_get_gaussian_weight[] = "\
rho = get_gaussian_weight(q,q_start,a,a_start,[n_config,n_modes])\n\nWrapper for ``get_gaussian_weight``.\
\n\nParameters\n----------\n"
"q : input rank-2 array('d') with bounds (n_config,n_modes)\n"
"q_start : input rank-2 array('d') with bounds (n_config,n_modes)\n"
"a : input rank-1 array('d') with bounds (n_modes)\n"
"a_start : input rank-1 array('d') with bounds (n_modes)\n"
"\nOther Parameters\n----------------\n"
"n_config : input int, optional\n    Default: shape(q, 0)\n"
"n_modes : input int, optional\n    Default: shape(q, 1)\n"
"\nReturns\n-------\n"
"rho : rank-1 array('d') with bounds (n_config)";
/*  */
static PyObject *f2py_rout_SCHAModules_stochastic_get_gaussian_weight(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *q = NULL;
    npy_intp q_Dims[2] = {-1, -1};
    const int q_Rank = 2;
    PyArrayObject *capi_q_tmp = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *q_start = NULL;
    npy_intp q_start_Dims[2] = {-1, -1};
    const int q_start_Rank = 2;
    PyArrayObject *capi_q_start_tmp = NULL;
    int capi_q_start_intent = 0;
    PyObject *q_start_capi = Py_None;
    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *a_start = NULL;
    npy_intp a_start_Dims[1] = {-1};
    const int a_start_Rank = 1;
    PyArrayObject *capi_a_start_tmp = NULL;
    int capi_a_start_intent = 0;
    PyObject *a_start_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    int n_config = 0;
    PyObject *n_config_capi = Py_None;
    int n_modes = 0;
    PyObject *n_modes_capi = Py_None;
    static char *capi_kwlist[] = {"q","q_start","a","a_start","n_config","n_modes",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|OO:SCHAModules.stochastic.get_gaussian_weight",\
        capi_kwlist,&q_capi,&q_start_capi,&a_capi,&a_start_capi,&n_config_capi,&n_modes_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable q */
    ;
    capi_q_intent |= F2PY_INTENT_IN;
    capi_q_tmp = array_from_pyobj(NPY_DOUBLE,q_Dims,q_Rank,capi_q_intent,q_capi);
    if (capi_q_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `q' of SCHAModules.stochastic.get_gaussian_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q = (double *)(PyArray_DATA(capi_q_tmp));

    /* Processing variable n_config */
    if (n_config_capi == Py_None) n_config = shape(q, 0); else
        f2py_success = int_from_pyobj(&n_config,n_config_capi,"SCHAModules.stochastic.get_gaussian_weight() 1st keyword (n_config) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(q, 0) == n_config,"shape(q, 0) == n_config","1st keyword n_config","get_gaussian_weight:n_config=%d",n_config) {
    /* Processing variable n_modes */
    if (n_modes_capi == Py_None) n_modes = shape(q, 1); else
        f2py_success = int_from_pyobj(&n_modes,n_modes_capi,"SCHAModules.stochastic.get_gaussian_weight() 2nd keyword (n_modes) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(q, 1) == n_modes,"shape(q, 1) == n_modes","2nd keyword n_modes","get_gaussian_weight:n_modes=%d",n_modes) {
    /* Processing variable q_start */
    q_start_Dims[0]=n_config,q_start_Dims[1]=n_modes;
    capi_q_start_intent |= F2PY_INTENT_IN;
    capi_q_start_tmp = array_from_pyobj(NPY_DOUBLE,q_start_Dims,q_start_Rank,capi_q_start_intent,q_start_capi);
    if (capi_q_start_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `q_start' of SCHAModules.stochastic.get_gaussian_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q_start = (double *)(PyArray_DATA(capi_q_start_tmp));

    /* Processing variable a_start */
    a_start_Dims[0]=n_modes;
    capi_a_start_intent |= F2PY_INTENT_IN;
    capi_a_start_tmp = array_from_pyobj(NPY_DOUBLE,a_start_Dims,a_start_Rank,capi_a_start_intent,a_start_capi);
    if (capi_a_start_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `a_start' of SCHAModules.stochastic.get_gaussian_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a_start = (double *)(PyArray_DATA(capi_a_start_tmp));

    /* Processing variable a */
    a_Dims[0]=n_modes;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `a' of SCHAModules.stochastic.get_gaussian_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable rho */
    rho_Dims[0]=n_config;
    capi_rho_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,Py_None);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `rho' of SCHAModules.stochastic.get_gaussian_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(q,q_start,a,a_start,rho,&n_config,&n_modes);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_rho_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
    if((PyObject *)capi_a_start_tmp!=a_start_capi) {
        Py_XDECREF(capi_a_start_tmp); }
    }  /*if (capi_a_start_tmp == NULL) ... else of a_start*/
    /* End of cleaning variable a_start */
    if((PyObject *)capi_q_start_tmp!=q_start_capi) {
        Py_XDECREF(capi_q_start_tmp); }
    }  /*if (capi_q_start_tmp == NULL) ... else of q_start*/
    /* End of cleaning variable q_start */
    } /*CHECKSCALAR(shape(q, 1) == n_modes)*/
    } /*if (f2py_success) of n_modes*/
    /* End of cleaning variable n_modes */
    } /*CHECKSCALAR(shape(q, 0) == n_config)*/
    } /*if (f2py_success) of n_config*/
    /* End of cleaning variable n_config */
    if((PyObject *)capi_q_tmp!=q_capi) {
        Py_XDECREF(capi_q_tmp); }
    }  /*if (capi_q_tmp == NULL) ... else of q*/
    /* End of cleaning variable q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of get_gaussian_weight *************************/

/*********************** get_gaussian_weight_eff_charge ***********************/
static char doc_f2py_rout_SCHAModules_stochastic_get_gaussian_weight_eff_charge[] = "\
rho = get_gaussian_weight_eff_charge(q,q_start,a,a_start,mu_relevant)\n\nWrapper for ``get_gaussian_weight_eff_charge``.\
\n\nParameters\n----------\n"
"q : input rank-2 array('d') with bounds (f2py_q_d0,f2py_q_d1)\n"
"q_start : input rank-2 array('d') with bounds (f2py_q_start_d0,f2py_q_start_d1)\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"a_start : input rank-2 array('d') with bounds (f2py_a_start_d0,f2py_a_start_d1)\n"
"mu_relevant : input rank-1 array('i') with bounds (f2py_mu_relevant_d0)\n"
"\nReturns\n-------\n"
"rho : rank-1 array('d') with bounds (f2py_rho_d0)";
/* #declfortranroutine# */
static PyObject *f2py_rout_SCHAModules_stochastic_get_gaussian_weight_eff_charge(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *q = NULL;
    npy_intp q_Dims[2] = {-1, -1};
    const int q_Rank = 2;
    PyArrayObject *capi_q_tmp = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *q_start = NULL;
    npy_intp q_start_Dims[2] = {-1, -1};
    const int q_start_Rank = 2;
    PyArrayObject *capi_q_start_tmp = NULL;
    int capi_q_start_intent = 0;
    PyObject *q_start_capi = Py_None;
    double *a = NULL;
    npy_intp a_Dims[2] = {-1, -1};
    const int a_Rank = 2;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *a_start = NULL;
    npy_intp a_start_Dims[2] = {-1, -1};
    const int a_start_Rank = 2;
    PyArrayObject *capi_a_start_tmp = NULL;
    int capi_a_start_intent = 0;
    PyObject *a_start_capi = Py_None;
    int *mu_relevant = NULL;
    npy_intp mu_relevant_Dims[1] = {-1};
    const int mu_relevant_Rank = 1;
    PyArrayObject *capi_mu_relevant_tmp = NULL;
    int capi_mu_relevant_intent = 0;
    PyObject *mu_relevant_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    int f2py_q_d0 = 0;
    int f2py_q_d1 = 0;
    int f2py_q_start_d0 = 0;
    int f2py_q_start_d1 = 0;
    int f2py_a_d0 = 0;
    int f2py_a_d1 = 0;
    int f2py_a_start_d0 = 0;
    int f2py_a_start_d1 = 0;
    int f2py_mu_relevant_d0 = 0;
    int f2py_rho_d0 = 0;
    static char *capi_kwlist[] = {"q","q_start","a","a_start","mu_relevant",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOO|:SCHAModules.stochastic.get_gaussian_weight_eff_charge",\
        capi_kwlist,&q_capi,&q_start_capi,&a_capi,&a_start_capi,&mu_relevant_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable q_start */
    ;
    capi_q_start_intent |= F2PY_INTENT_IN;
    capi_q_start_tmp = array_from_pyobj(NPY_DOUBLE,q_start_Dims,q_start_Rank,capi_q_start_intent,q_start_capi);
    if (capi_q_start_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `q_start' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q_start = (double *)(PyArray_DATA(capi_q_start_tmp));

    /* Processing variable q */
    ;
    capi_q_intent |= F2PY_INTENT_IN;
    capi_q_tmp = array_from_pyobj(NPY_DOUBLE,q_Dims,q_Rank,capi_q_intent,q_capi);
    if (capi_q_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `q' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q = (double *)(PyArray_DATA(capi_q_tmp));

    /* Processing variable a_start */
    ;
    capi_a_start_intent |= F2PY_INTENT_IN;
    capi_a_start_tmp = array_from_pyobj(NPY_DOUBLE,a_start_Dims,a_start_Rank,capi_a_start_intent,a_start_capi);
    if (capi_a_start_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `a_start' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a_start = (double *)(PyArray_DATA(capi_a_start_tmp));

    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `a' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

    /* Processing variable mu_relevant */
    ;
    capi_mu_relevant_intent |= F2PY_INTENT_IN;
    capi_mu_relevant_tmp = array_from_pyobj(NPY_INT,mu_relevant_Dims,mu_relevant_Rank,capi_mu_relevant_intent,mu_relevant_capi);
    if (capi_mu_relevant_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `mu_relevant' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mu_relevant = (int *)(PyArray_DATA(capi_mu_relevant_tmp));

    /* Processing variable rho */
    ;
    capi_rho_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,Py_None);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `rho' of SCHAModules.stochastic.get_gaussian_weight_eff_charge to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable f2py_q_d0 */
    f2py_q_d0 = shape(q, 0);
    /* Processing variable f2py_q_d1 */
    f2py_q_d1 = shape(q, 1);
    /* Processing variable f2py_q_start_d0 */
    f2py_q_start_d0 = shape(q_start, 0);
    /* Processing variable f2py_q_start_d1 */
    f2py_q_start_d1 = shape(q_start, 1);
    /* Processing variable f2py_a_d0 */
    f2py_a_d0 = shape(a, 0);
    /* Processing variable f2py_a_d1 */
    f2py_a_d1 = shape(a, 1);
    /* Processing variable f2py_a_start_d0 */
    f2py_a_start_d0 = shape(a_start, 0);
    /* Processing variable f2py_a_start_d1 */
    f2py_a_start_d1 = shape(a_start, 1);
    /* Processing variable f2py_mu_relevant_d0 */
    f2py_mu_relevant_d0 = shape(mu_relevant, 0);
    /* Processing variable f2py_rho_d0 */
    f2py_rho_d0 = shape(rho, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(q,q_start,a,a_start,mu_relevant,rho,&f2py_q_d0,&f2py_q_d1,&f2py_q_start_d0,&f2py_q_start_d1,&f2py_a_d0,&f2py_a_d1,&f2py_a_start_d0,&f2py_a_start_d1,&f2py_mu_relevant_d0,&f2py_rho_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_rho_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_rho_d0 */
    /* End of cleaning variable f2py_mu_relevant_d0 */
    /* End of cleaning variable f2py_a_start_d1 */
    /* End of cleaning variable f2py_a_start_d0 */
    /* End of cleaning variable f2py_a_d1 */
    /* End of cleaning variable f2py_a_d0 */
    /* End of cleaning variable f2py_q_start_d1 */
    /* End of cleaning variable f2py_q_start_d0 */
    /* End of cleaning variable f2py_q_d1 */
    /* End of cleaning variable f2py_q_d0 */
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_mu_relevant_tmp!=mu_relevant_capi) {
        Py_XDECREF(capi_mu_relevant_tmp); }
    }  /*if (capi_mu_relevant_tmp == NULL) ... else of mu_relevant*/
    /* End of cleaning variable mu_relevant */
    if((PyObject *)capi_a_tmp!=a_capi) {
        Py_XDECREF(capi_a_tmp); }
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
    if((PyObject *)capi_a_start_tmp!=a_start_capi) {
        Py_XDECREF(capi_a_start_tmp); }
    }  /*if (capi_a_start_tmp == NULL) ... else of a_start*/
    /* End of cleaning variable a_start */
    if((PyObject *)capi_q_tmp!=q_capi) {
        Py_XDECREF(capi_q_tmp); }
    }  /*if (capi_q_tmp == NULL) ... else of q*/
    /* End of cleaning variable q */
    if((PyObject *)capi_q_start_tmp!=q_start_capi) {
        Py_XDECREF(capi_q_start_tmp); }
    }  /*if (capi_q_start_tmp == NULL) ... else of q_start*/
    /* End of cleaning variable q_start */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************* end of get_gaussian_weight_eff_charge *******************/

/**************************** average_error_weight ****************************/
static char doc_f2py_rout_SCHAModules_stochastic_average_error_weight[] = "\
av_f,error_f = average_error_weight(f,rho,log_err)\n\nWrapper for ``average_error_weight``.\
\n\nParameters\n----------\n"
"f : input rank-1 array('d') with bounds (f2py_f_d0)\n"
"rho : input rank-1 array('d') with bounds (f2py_rho_d0)\n"
"log_err : input string(len=10)\n"
"\nReturns\n-------\n"
"av_f : float\n"
"error_f : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_SCHAModules_stochastic_average_error_weight(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,string,double*,double*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *f = NULL;
    npy_intp f_Dims[1] = {-1};
    const int f_Rank = 1;
    PyArrayObject *capi_f_tmp = NULL;
    int capi_f_intent = 0;
    PyObject *f_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double av_f = 0;
    double error_f = 0;
    int f2py_f_d0 = 0;
    int f2py_rho_d0 = 0;
    static char *capi_kwlist[] = {"f","rho","log_err",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:SCHAModules.stochastic.average_error_weight",\
        capi_kwlist,&f_capi,&rho_capi,&log_err_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable f */
    ;
    capi_f_intent |= F2PY_INTENT_IN;
    capi_f_tmp = array_from_pyobj(NPY_DOUBLE,f_Dims,f_Rank,capi_f_intent,f_capi);
    if (capi_f_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `f' of SCHAModules.stochastic.average_error_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        f = (double *)(PyArray_DATA(capi_f_tmp));

    /* Processing variable rho */
    ;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `rho' of SCHAModules.stochastic.average_error_weight to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 3rd argument`log_err' of SCHAModules.stochastic.average_error_weight to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable av_f */
    /* Processing variable error_f */
    /* Processing variable f2py_f_d0 */
    f2py_f_d0 = shape(f, 0);
    /* Processing variable f2py_rho_d0 */
    f2py_rho_d0 = shape(rho, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(f,rho,log_err,&av_f,&error_f,&f2py_f_d0,&f2py_rho_d0,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("dd",av_f,error_f);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_rho_d0 */
    /* End of cleaning variable f2py_f_d0 */
    /* End of cleaning variable error_f */
    /* End of cleaning variable av_f */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_f_tmp!=f_capi) {
        Py_XDECREF(capi_f_tmp); }
    }  /*if (capi_f_tmp == NULL) ... else of f*/
    /* End of cleaning variable f */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of average_error_weight ************************/

/******************************* random_sphere *******************************/
static char doc_f2py_rout_SCHAModules_stochastic_random_sphere[] = "\
v_rand = random_sphere()\n\nWrapper for ``random_sphere``.\
\n\nReturns\n-------\n"
"v_rand : rank-1 array('d') with bounds (3)";
/*  */
static PyObject *f2py_rout_SCHAModules_stochastic_random_sphere(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *v_rand = NULL;
    npy_intp v_rand_Dims[1] = {-1};
    const int v_rand_Rank = 1;
    PyArrayObject *capi_v_rand_tmp = NULL;
    int capi_v_rand_intent = 0;
    static char *capi_kwlist[] = {NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "|:SCHAModules.stochastic.random_sphere",\
        capi_kwlist))
        return NULL;
/*frompyobj*/
    /* Processing variable v_rand */
    v_rand_Dims[0]=3;
    capi_v_rand_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_v_rand_tmp = array_from_pyobj(NPY_DOUBLE,v_rand_Dims,v_rand_Rank,capi_v_rand_intent,Py_None);
    if (capi_v_rand_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `v_rand' of SCHAModules.stochastic.random_sphere to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        v_rand = (double *)(PyArray_DATA(capi_v_rand_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(v_rand);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_v_rand_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_v_rand_tmp == NULL) ... else of v_rand*/
    /* End of cleaning variable v_rand */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of random_sphere ****************************/

/*********************************** w_to_a ***********************************/
static char doc_f2py_rout_SCHAModules_thermodynamic_w_to_a[] = "\
a = w_to_a(w,t,[n])\n\nWrapper for ``w_to_a``.\
\n\nParameters\n----------\n"
"w : input rank-1 array('d') with bounds (n)\n"
"t : input float\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(w, 0)\n"
"\nReturns\n-------\n"
"a : rank-1 array('d') with bounds (n)";
/*  */
static PyObject *f2py_rout_SCHAModules_thermodynamic_w_to_a(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w = NULL;
    npy_intp w_Dims[1] = {-1};
    const int w_Rank = 1;
    PyArrayObject *capi_w_tmp = NULL;
    int capi_w_intent = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_tmp = NULL;
    int capi_a_intent = 0;
    int n = 0;
    PyObject *n_capi = Py_None;
    static char *capi_kwlist[] = {"w","t","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:SCHAModules.thermodynamic.w_to_a",\
        capi_kwlist,&w_capi,&t_capi,&n_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.thermodynamic.w_to_a() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable w */
    ;
    capi_w_intent |= F2PY_INTENT_IN;
    capi_w_tmp = array_from_pyobj(NPY_DOUBLE,w_Dims,w_Rank,capi_w_intent,w_capi);
    if (capi_w_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `w' of SCHAModules.thermodynamic.w_to_a to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        w = (double *)(PyArray_DATA(capi_w_tmp));

    /* Processing variable n */
    if (n_capi == Py_None) n = shape(w, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"SCHAModules.thermodynamic.w_to_a() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w, 0) == n,"shape(w, 0) == n","1st keyword n","w_to_a:n=%d",n) {
    /* Processing variable a */
    a_Dims[0]=n;
    capi_a_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,Py_None);
    if (capi_a_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `a' of SCHAModules.thermodynamic.w_to_a to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        a = (double *)(PyArray_DATA(capi_a_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w,&t,a,&n);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_a_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_a_tmp == NULL) ... else of a*/
    /* End of cleaning variable a */
    } /*CHECKSCALAR(shape(w, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
    if((PyObject *)capi_w_tmp!=w_capi) {
        Py_XDECREF(capi_w_tmp); }
    }  /*if (capi_w_tmp == NULL) ... else of w*/
    /* End of cleaning variable w */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of w_to_a *******************************/

/********************************** w_to_da **********************************/
static char doc_f2py_rout_SCHAModules_thermodynamic_w_to_da[] = "\
da = w_to_da(w,t,[n])\n\nWrapper for ``w_to_da``.\
\n\nParameters\n----------\n"
"w : input rank-1 array('d') with bounds (n)\n"
"t : input float\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(w, 0)\n"
"\nReturns\n-------\n"
"da : rank-1 array('d') with bounds (n)";
/*  */
static PyObject *f2py_rout_SCHAModules_thermodynamic_w_to_da(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w = NULL;
    npy_intp w_Dims[1] = {-1};
    const int w_Rank = 1;
    PyArrayObject *capi_w_tmp = NULL;
    int capi_w_intent = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *da = NULL;
    npy_intp da_Dims[1] = {-1};
    const int da_Rank = 1;
    PyArrayObject *capi_da_tmp = NULL;
    int capi_da_intent = 0;
    int n = 0;
    PyObject *n_capi = Py_None;
    static char *capi_kwlist[] = {"w","t","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:SCHAModules.thermodynamic.w_to_da",\
        capi_kwlist,&w_capi,&t_capi,&n_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.thermodynamic.w_to_da() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable w */
    ;
    capi_w_intent |= F2PY_INTENT_IN;
    capi_w_tmp = array_from_pyobj(NPY_DOUBLE,w_Dims,w_Rank,capi_w_intent,w_capi);
    if (capi_w_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `w' of SCHAModules.thermodynamic.w_to_da to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        w = (double *)(PyArray_DATA(capi_w_tmp));

    /* Processing variable n */
    if (n_capi == Py_None) n = shape(w, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"SCHAModules.thermodynamic.w_to_da() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w, 0) == n,"shape(w, 0) == n","1st keyword n","w_to_da:n=%d",n) {
    /* Processing variable da */
    da_Dims[0]=n;
    capi_da_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_da_tmp = array_from_pyobj(NPY_DOUBLE,da_Dims,da_Rank,capi_da_intent,Py_None);
    if (capi_da_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `da' of SCHAModules.thermodynamic.w_to_da to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        da = (double *)(PyArray_DATA(capi_da_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w,&t,da,&n);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_da_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_da_tmp == NULL) ... else of da*/
    /* End of cleaning variable da */
    } /*CHECKSCALAR(shape(w, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
    if((PyObject *)capi_w_tmp!=w_capi) {
        Py_XDECREF(capi_w_tmp); }
    }  /*if (capi_w_tmp == NULL) ... else of w*/
    /* End of cleaning variable w */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of w_to_da *******************************/

/********************************** dw_f0_u0 **********************************/
static char doc_f2py_rout_SCHAModules_thermodynamic_dw_f0_u0[] = "\
result_dw_f0_u0 = dw_f0_u0(w,t)\n\nWrapper for ``dw_f0_u0``.\
\n\nParameters\n----------\n"
"w : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"result_dw_f0_u0 : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_SCHAModules_thermodynamic_dw_f0_u0(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double dw_f0_u0 = 0;
    double w = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    static char *capi_kwlist[] = {"w","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:SCHAModules.thermodynamic.dw_f0_u0",\
        capi_kwlist,&w_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w */
        f2py_success = double_from_pyobj(&w,w_capi,"SCHAModules.thermodynamic.dw_f0_u0() 1st argument (w) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.thermodynamic.dw_f0_u0() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable dw_f0_u0 */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&dw_f0_u0,&w,&t);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",dw_f0_u0);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable dw_f0_u0 */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of w*/
    /* End of cleaning variable w */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of dw_f0_u0 ******************************/

/************************************* nb *************************************/
static char doc_f2py_rout_SCHAModules_thermodynamic_nb[] = "\
result_nb = nb(w,t)\n\nWrapper for ``nb``.\
\n\nParameters\n----------\n"
"w : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"result_nb : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_SCHAModules_thermodynamic_nb(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double nb = 0;
    double w = 0;
    PyObject *w_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    static char *capi_kwlist[] = {"w","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:SCHAModules.thermodynamic.nb",\
        capi_kwlist,&w_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w */
        f2py_success = double_from_pyobj(&w,w_capi,"SCHAModules.thermodynamic.nb() 1st argument (w) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.thermodynamic.nb() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable nb */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&nb,&w,&t);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",nb);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable nb */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of w*/
    /* End of cleaning variable w */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************************* end of nb *********************************/

/****************************** get_df_da_nonav ******************************/
static char doc_f2py_rout_SCHAModules_anharmonic_get_df_da_nonav[] = "\
df_da = get_df_da_nonav(w,w_harmonic,t,e,forces,q,mass,stat_method,[l,n,m])\n\nWrapper for ``get_df_da_nonav``.\
\n\nParameters\n----------\n"
"w : input rank-1 array('d') with bounds (n)\n"
"w_harmonic : input rank-1 array('d') with bounds (n)\n"
"t : input float\n"
"e : input rank-2 array('d') with bounds (3 * m,n)\n"
"forces : input rank-3 array('d') with bounds (l,m,3)\n"
"q : input rank-2 array('d') with bounds (l,n)\n"
"mass : input rank-1 array('d') with bounds (m)\n"
"stat_method : input string(len=11)\n"
"\nOther Parameters\n----------------\n"
"l : input int, optional\n    Default: shape(forces, 0)\n"
"n : input int, optional\n    Default: shape(w, 0)\n"
"m : input int, optional\n    Default: shape(e, 0) / 3\n"
"\nReturns\n-------\n"
"df_da : rank-2 array('d') with bounds (l,n)";
/*  */
static PyObject *f2py_rout_SCHAModules_anharmonic_get_df_da_nonav(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,double*,string,double*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w = NULL;
    npy_intp w_Dims[1] = {-1};
    const int w_Rank = 1;
    PyArrayObject *capi_w_tmp = NULL;
    int capi_w_intent = 0;
    PyObject *w_capi = Py_None;
    double *w_harmonic = NULL;
    npy_intp w_harmonic_Dims[1] = {-1};
    const int w_harmonic_Rank = 1;
    PyArrayObject *capi_w_harmonic_tmp = NULL;
    int capi_w_harmonic_intent = 0;
    PyObject *w_harmonic_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *e = NULL;
    npy_intp e_Dims[2] = {-1, -1};
    const int e_Rank = 2;
    PyArrayObject *capi_e_tmp = NULL;
    int capi_e_intent = 0;
    PyObject *e_capi = Py_None;
    double *forces = NULL;
    npy_intp forces_Dims[3] = {-1, -1, -1};
    const int forces_Rank = 3;
    PyArrayObject *capi_forces_tmp = NULL;
    int capi_forces_intent = 0;
    PyObject *forces_capi = Py_None;
    double *q = NULL;
    npy_intp q_Dims[2] = {-1, -1};
    const int q_Rank = 2;
    PyArrayObject *capi_q_tmp = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    string stat_method = NULL;
    int slen(stat_method);
    PyObject *stat_method_capi = Py_None;
    double *df_da = NULL;
    npy_intp df_da_Dims[2] = {-1, -1};
    const int df_da_Rank = 2;
    PyArrayObject *capi_df_da_tmp = NULL;
    int capi_df_da_intent = 0;
    int l = 0;
    PyObject *l_capi = Py_None;
    int n = 0;
    PyObject *n_capi = Py_None;
    int m = 0;
    PyObject *m_capi = Py_None;
    static char *capi_kwlist[] = {"w","w_harmonic","t","e","forces","q","mass","stat_method","l","n","m",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OOO:SCHAModules.anharmonic.get_df_da_nonav",\
        capi_kwlist,&w_capi,&w_harmonic_capi,&t_capi,&e_capi,&forces_capi,&q_capi,&mass_capi,&stat_method_capi,&l_capi,&n_capi,&m_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w */
    ;
    capi_w_intent |= F2PY_INTENT_IN;
    capi_w_tmp = array_from_pyobj(NPY_DOUBLE,w_Dims,w_Rank,capi_w_intent,w_capi);
    if (capi_w_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `w' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        w = (double *)(PyArray_DATA(capi_w_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.anharmonic.get_df_da_nonav() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable stat_method */
    slen(stat_method) = 11;
    f2py_success = string_from_pyobj(&stat_method,&slen(stat_method),"",stat_method_capi,"string_from_pyobj failed in converting 8th argument`stat_method' of SCHAModules.anharmonic.get_df_da_nonav to C string");
    if (f2py_success) {
        STRINGPADN(stat_method, slen(stat_method), '\0', ' ');
    /* Processing variable n */
    if (n_capi == Py_None) n = shape(w, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"SCHAModules.anharmonic.get_df_da_nonav() 2nd keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w, 0) == n,"shape(w, 0) == n","2nd keyword n","get_df_da_nonav:n=%d",n) {
    /* Processing variable w_harmonic */
    w_harmonic_Dims[0]=n;
    capi_w_harmonic_intent |= F2PY_INTENT_IN;
    capi_w_harmonic_tmp = array_from_pyobj(NPY_DOUBLE,w_harmonic_Dims,w_harmonic_Rank,capi_w_harmonic_intent,w_harmonic_capi);
    if (capi_w_harmonic_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `w_harmonic' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        w_harmonic = (double *)(PyArray_DATA(capi_w_harmonic_tmp));

    /* Processing variable e */
    e_Dims[1]=n;
    capi_e_intent |= F2PY_INTENT_IN;
    capi_e_tmp = array_from_pyobj(NPY_DOUBLE,e_Dims,e_Rank,capi_e_intent,e_capi);
    if (capi_e_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `e' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        e = (double *)(PyArray_DATA(capi_e_tmp));

    /* Processing variable m */
    if (m_capi == Py_None) m = shape(e, 0) / 3; else
        f2py_success = int_from_pyobj(&m,m_capi,"SCHAModules.anharmonic.get_df_da_nonav() 3rd keyword (m) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(e, 0) == 3 * m,"shape(e, 0) == 3 * m","3rd keyword m","get_df_da_nonav:m=%d",m) {
    /* Processing variable forces */
    forces_Dims[1]=m,forces_Dims[2]=3;
    capi_forces_intent |= F2PY_INTENT_IN;
    capi_forces_tmp = array_from_pyobj(NPY_DOUBLE,forces_Dims,forces_Rank,capi_forces_intent,forces_capi);
    if (capi_forces_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `forces' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        forces = (double *)(PyArray_DATA(capi_forces_tmp));

    /* Processing variable mass */
    mass_Dims[0]=m;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `mass' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable l */
    if (l_capi == Py_None) l = shape(forces, 0); else
        f2py_success = int_from_pyobj(&l,l_capi,"SCHAModules.anharmonic.get_df_da_nonav() 1st keyword (l) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(forces, 0) == l,"shape(forces, 0) == l","1st keyword l","get_df_da_nonav:l=%d",l) {
    /* Processing variable q */
    q_Dims[0]=l,q_Dims[1]=n;
    capi_q_intent |= F2PY_INTENT_IN;
    capi_q_tmp = array_from_pyobj(NPY_DOUBLE,q_Dims,q_Rank,capi_q_intent,q_capi);
    if (capi_q_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `q' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q = (double *)(PyArray_DATA(capi_q_tmp));

    /* Processing variable df_da */
    df_da_Dims[0]=l,df_da_Dims[1]=n;
    capi_df_da_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_df_da_tmp = array_from_pyobj(NPY_DOUBLE,df_da_Dims,df_da_Rank,capi_df_da_intent,Py_None);
    if (capi_df_da_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `df_da' of SCHAModules.anharmonic.get_df_da_nonav to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        df_da = (double *)(PyArray_DATA(capi_df_da_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w,w_harmonic,&t,e,forces,q,mass,stat_method,df_da,&l,&n,&m,slen(stat_method));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_df_da_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_df_da_tmp == NULL) ... else of df_da*/
    /* End of cleaning variable df_da */
    if((PyObject *)capi_q_tmp!=q_capi) {
        Py_XDECREF(capi_q_tmp); }
    }  /*if (capi_q_tmp == NULL) ... else of q*/
    /* End of cleaning variable q */
    } /*CHECKSCALAR(shape(forces, 0) == l)*/
    } /*if (f2py_success) of l*/
    /* End of cleaning variable l */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    if((PyObject *)capi_forces_tmp!=forces_capi) {
        Py_XDECREF(capi_forces_tmp); }
    }  /*if (capi_forces_tmp == NULL) ... else of forces*/
    /* End of cleaning variable forces */
    } /*CHECKSCALAR(shape(e, 0) == 3 * m)*/
    } /*if (f2py_success) of m*/
    /* End of cleaning variable m */
    if((PyObject *)capi_e_tmp!=e_capi) {
        Py_XDECREF(capi_e_tmp); }
    }  /*if (capi_e_tmp == NULL) ... else of e*/
    /* End of cleaning variable e */
    if((PyObject *)capi_w_harmonic_tmp!=w_harmonic_capi) {
        Py_XDECREF(capi_w_harmonic_tmp); }
    }  /*if (capi_w_harmonic_tmp == NULL) ... else of w_harmonic*/
    /* End of cleaning variable w_harmonic */
    } /*CHECKSCALAR(shape(w, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
        STRINGFREE(stat_method);
    }  /*if (f2py_success) of stat_method*/
    /* End of cleaning variable stat_method */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_w_tmp!=w_capi) {
        Py_XDECREF(capi_w_tmp); }
    }  /*if (capi_w_tmp == NULL) ... else of w*/
    /* End of cleaning variable w */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of get_df_da_nonav ***************************/

/*************************** get_da_dcr_and_de_dcr ***************************/
static char doc_f2py_rout_SCHAModules_anharmonic_get_da_dcr_and_de_dcr[] = "\
da_dcr,de_dcr = get_da_dcr_and_de_dcr(wr,er,t,mass,x_i,y_i,[n,m])\n\nWrapper for ``get_da_dcr_and_de_dcr``.\
\n\nParameters\n----------\n"
"wr : input rank-1 array('d') with bounds (n)\n"
"er : input rank-2 array('d') with bounds (3 * m,n)\n"
"t : input float\n"
"mass : input rank-1 array('d') with bounds (m)\n"
"x_i : input int\n"
"y_i : input int\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(wr, 0)\n"
"m : input int, optional\n    Default: shape(er, 0) / 3\n"
"\nReturns\n-------\n"
"da_dcr : rank-1 array('d') with bounds (n)\n"
"de_dcr : rank-2 array('d') with bounds (3 * m,n)";
/*  */
static PyObject *f2py_rout_SCHAModules_anharmonic_get_da_dcr_and_de_dcr(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *wr = NULL;
    npy_intp wr_Dims[1] = {-1};
    const int wr_Rank = 1;
    PyArrayObject *capi_wr_tmp = NULL;
    int capi_wr_intent = 0;
    PyObject *wr_capi = Py_None;
    double *er = NULL;
    npy_intp er_Dims[2] = {-1, -1};
    const int er_Rank = 2;
    PyArrayObject *capi_er_tmp = NULL;
    int capi_er_intent = 0;
    PyObject *er_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int x_i = 0;
    PyObject *x_i_capi = Py_None;
    int y_i = 0;
    PyObject *y_i_capi = Py_None;
    double *da_dcr = NULL;
    npy_intp da_dcr_Dims[1] = {-1};
    const int da_dcr_Rank = 1;
    PyArrayObject *capi_da_dcr_tmp = NULL;
    int capi_da_dcr_intent = 0;
    double *de_dcr = NULL;
    npy_intp de_dcr_Dims[2] = {-1, -1};
    const int de_dcr_Rank = 2;
    PyArrayObject *capi_de_dcr_tmp = NULL;
    int capi_de_dcr_intent = 0;
    int n = 0;
    PyObject *n_capi = Py_None;
    int m = 0;
    PyObject *m_capi = Py_None;
    static char *capi_kwlist[] = {"wr","er","t","mass","x_i","y_i","n","m",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OO:SCHAModules.anharmonic.get_da_dcr_and_de_dcr",\
        capi_kwlist,&wr_capi,&er_capi,&t_capi,&mass_capi,&x_i_capi,&y_i_capi,&n_capi,&m_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable wr */
    ;
    capi_wr_intent |= F2PY_INTENT_IN;
    capi_wr_tmp = array_from_pyobj(NPY_DOUBLE,wr_Dims,wr_Rank,capi_wr_intent,wr_capi);
    if (capi_wr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `wr' of SCHAModules.anharmonic.get_da_dcr_and_de_dcr to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        wr = (double *)(PyArray_DATA(capi_wr_tmp));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"SCHAModules.anharmonic.get_da_dcr_and_de_dcr() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable x_i */
        f2py_success = int_from_pyobj(&x_i,x_i_capi,"SCHAModules.anharmonic.get_da_dcr_and_de_dcr() 5th argument (x_i) can't be converted to int");
    if (f2py_success) {
    /* Processing variable y_i */
        f2py_success = int_from_pyobj(&y_i,y_i_capi,"SCHAModules.anharmonic.get_da_dcr_and_de_dcr() 6th argument (y_i) can't be converted to int");
    if (f2py_success) {
    /* Processing variable n */
    if (n_capi == Py_None) n = shape(wr, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"SCHAModules.anharmonic.get_da_dcr_and_de_dcr() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(wr, 0) == n,"shape(wr, 0) == n","1st keyword n","get_da_dcr_and_de_dcr:n=%d",n) {
    /* Processing variable er */
    er_Dims[1]=n;
    capi_er_intent |= F2PY_INTENT_IN;
    capi_er_tmp = array_from_pyobj(NPY_DOUBLE,er_Dims,er_Rank,capi_er_intent,er_capi);
    if (capi_er_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `er' of SCHAModules.anharmonic.get_da_dcr_and_de_dcr to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        er = (double *)(PyArray_DATA(capi_er_tmp));

    /* Processing variable da_dcr */
    da_dcr_Dims[0]=n;
    capi_da_dcr_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_da_dcr_tmp = array_from_pyobj(NPY_DOUBLE,da_dcr_Dims,da_dcr_Rank,capi_da_dcr_intent,Py_None);
    if (capi_da_dcr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `da_dcr' of SCHAModules.anharmonic.get_da_dcr_and_de_dcr to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        da_dcr = (double *)(PyArray_DATA(capi_da_dcr_tmp));

    /* Processing variable m */
    if (m_capi == Py_None) m = shape(er, 0) / 3; else
        f2py_success = int_from_pyobj(&m,m_capi,"SCHAModules.anharmonic.get_da_dcr_and_de_dcr() 2nd keyword (m) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(er, 0) == 3 * m,"shape(er, 0) == 3 * m","2nd keyword m","get_da_dcr_and_de_dcr:m=%d",m) {
    /* Processing variable mass */
    mass_Dims[0]=m;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `mass' of SCHAModules.anharmonic.get_da_dcr_and_de_dcr to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable de_dcr */
    de_dcr_Dims[0]=3 * m,de_dcr_Dims[1]=n;
    capi_de_dcr_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    capi_de_dcr_tmp = array_from_pyobj(NPY_DOUBLE,de_dcr_Dims,de_dcr_Rank,capi_de_dcr_intent,Py_None);
    if (capi_de_dcr_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting hidden `de_dcr' of SCHAModules.anharmonic.get_da_dcr_and_de_dcr to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        de_dcr = (double *)(PyArray_DATA(capi_de_dcr_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(wr,er,&t,mass,&x_i,&y_i,da_dcr,de_dcr,&n,&m);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_da_dcr_tmp,capi_de_dcr_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /*if (capi_de_dcr_tmp == NULL) ... else of de_dcr*/
    /* End of cleaning variable de_dcr */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*CHECKSCALAR(shape(er, 0) == 3 * m)*/
    } /*if (f2py_success) of m*/
    /* End of cleaning variable m */
    }  /*if (capi_da_dcr_tmp == NULL) ... else of da_dcr*/
    /* End of cleaning variable da_dcr */
    if((PyObject *)capi_er_tmp!=er_capi) {
        Py_XDECREF(capi_er_tmp); }
    }  /*if (capi_er_tmp == NULL) ... else of er*/
    /* End of cleaning variable er */
    } /*CHECKSCALAR(shape(wr, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
    } /*if (f2py_success) of y_i*/
    /* End of cleaning variable y_i */
    } /*if (f2py_success) of x_i*/
    /* End of cleaning variable x_i */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_wr_tmp!=wr_capi) {
        Py_XDECREF(capi_wr_tmp); }
    }  /*if (capi_wr_tmp == NULL) ... else of wr*/
    /* End of cleaning variable wr */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of get_da_dcr_and_de_dcr ************************/

/**************************** get_df_dcoeff_av_new ****************************/
static char doc_f2py_rout_SCHAModules_anharmonic_get_df_dcoeff_av_new[] = "\
dfdc,delta_dfdc = get_df_dcoeff_av_new(df,da,forces,q,mass,dedc,rho,minim_polvec,log_err,[r,s,t])\n\nWrapper for ``get_df_dcoeff_av_new``.\
\n\nParameters\n----------\n"
"df : input rank-2 array('d') with bounds (r,s)\n"
"da : input rank-1 array('d') with bounds (s)\n"
"forces : input rank-3 array('d') with bounds (r,t,3)\n"
"q : input rank-2 array('d') with bounds (r,s)\n"
"mass : input rank-1 array('d') with bounds (t)\n"
"dedc : input rank-2 array('d') with bounds (3 * t,s)\n"
"rho : input rank-1 array('d') with bounds (r)\n"
"minim_polvec : input int\n"
"log_err : input string(len=10)\n"
"\nOther Parameters\n----------------\n"
"r : input int, optional\n    Default: shape(df, 0)\n"
"s : input int, optional\n    Default: shape(df, 1)\n"
"t : input int, optional\n    Default: shape(forces, 1)\n"
"\nReturns\n-------\n"
"dfdc : float\n"
"delta_dfdc : float";
/*  */
static PyObject *f2py_rout_SCHAModules_anharmonic_get_df_dcoeff_av_new(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,double*,int*,string,double*,double*,int*,int*,int*,size_t)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *df = NULL;
    npy_intp df_Dims[2] = {-1, -1};
    const int df_Rank = 2;
    PyArrayObject *capi_df_tmp = NULL;
    int capi_df_intent = 0;
    PyObject *df_capi = Py_None;
    double *da = NULL;
    npy_intp da_Dims[1] = {-1};
    const int da_Rank = 1;
    PyArrayObject *capi_da_tmp = NULL;
    int capi_da_intent = 0;
    PyObject *da_capi = Py_None;
    double *forces = NULL;
    npy_intp forces_Dims[3] = {-1, -1, -1};
    const int forces_Rank = 3;
    PyArrayObject *capi_forces_tmp = NULL;
    int capi_forces_intent = 0;
    PyObject *forces_capi = Py_None;
    double *q = NULL;
    npy_intp q_Dims[2] = {-1, -1};
    const int q_Rank = 2;
    PyArrayObject *capi_q_tmp = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_tmp = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    double *dedc = NULL;
    npy_intp dedc_Dims[2] = {-1, -1};
    const int dedc_Rank = 2;
    PyArrayObject *capi_dedc_tmp = NULL;
    int capi_dedc_intent = 0;
    PyObject *dedc_capi = Py_None;
    double *rho = NULL;
    npy_intp rho_Dims[1] = {-1};
    const int rho_Rank = 1;
    PyArrayObject *capi_rho_tmp = NULL;
    int capi_rho_intent = 0;
    PyObject *rho_capi = Py_None;
    int minim_polvec = 0;
    PyObject *minim_polvec_capi = Py_None;
    string log_err = NULL;
    int slen(log_err);
    PyObject *log_err_capi = Py_None;
    double dfdc = 0;
    double delta_dfdc = 0;
    int r = 0;
    PyObject *r_capi = Py_None;
    int s = 0;
    PyObject *s_capi = Py_None;
    int t = 0;
    PyObject *t_capi = Py_None;
    static char *capi_kwlist[] = {"df","da","forces","q","mass","dedc","rho","minim_polvec","log_err","r","s","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OOO:SCHAModules.anharmonic.get_df_dcoeff_av_new",\
        capi_kwlist,&df_capi,&da_capi,&forces_capi,&q_capi,&mass_capi,&dedc_capi,&rho_capi,&minim_polvec_capi,&log_err_capi,&r_capi,&s_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable df */
    ;
    capi_df_intent |= F2PY_INTENT_IN;
    capi_df_tmp = array_from_pyobj(NPY_DOUBLE,df_Dims,df_Rank,capi_df_intent,df_capi);
    if (capi_df_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 1st argument `df' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        df = (double *)(PyArray_DATA(capi_df_tmp));

    /* Processing variable minim_polvec */
        minim_polvec = (int)PyObject_IsTrue(minim_polvec_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable log_err */
    slen(log_err) = 10;
    f2py_success = string_from_pyobj(&log_err,&slen(log_err),"",log_err_capi,"string_from_pyobj failed in converting 9th argument`log_err' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C string");
    if (f2py_success) {
        STRINGPADN(log_err, slen(log_err), '\0', ' ');
    /* Processing variable dfdc */
    /* Processing variable delta_dfdc */
    /* Processing variable r */
    if (r_capi == Py_None) r = shape(df, 0); else
        f2py_success = int_from_pyobj(&r,r_capi,"SCHAModules.anharmonic.get_df_dcoeff_av_new() 1st keyword (r) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(df, 0) == r,"shape(df, 0) == r","1st keyword r","get_df_dcoeff_av_new:r=%d",r) {
    /* Processing variable s */
    if (s_capi == Py_None) s = shape(df, 1); else
        f2py_success = int_from_pyobj(&s,s_capi,"SCHAModules.anharmonic.get_df_dcoeff_av_new() 2nd keyword (s) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(df, 1) == s,"shape(df, 1) == s","2nd keyword s","get_df_dcoeff_av_new:s=%d",s) {
    /* Processing variable q */
    q_Dims[0]=r,q_Dims[1]=s;
    capi_q_intent |= F2PY_INTENT_IN;
    capi_q_tmp = array_from_pyobj(NPY_DOUBLE,q_Dims,q_Rank,capi_q_intent,q_capi);
    if (capi_q_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 4th argument `q' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        q = (double *)(PyArray_DATA(capi_q_tmp));

    /* Processing variable da */
    da_Dims[0]=s;
    capi_da_intent |= F2PY_INTENT_IN;
    capi_da_tmp = array_from_pyobj(NPY_DOUBLE,da_Dims,da_Rank,capi_da_intent,da_capi);
    if (capi_da_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 2nd argument `da' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        da = (double *)(PyArray_DATA(capi_da_tmp));

    /* Processing variable forces */
    forces_Dims[0]=r,forces_Dims[2]=3;
    capi_forces_intent |= F2PY_INTENT_IN;
    capi_forces_tmp = array_from_pyobj(NPY_DOUBLE,forces_Dims,forces_Rank,capi_forces_intent,forces_capi);
    if (capi_forces_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 3rd argument `forces' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        forces = (double *)(PyArray_DATA(capi_forces_tmp));

    /* Processing variable rho */
    rho_Dims[0]=r;
    capi_rho_intent |= F2PY_INTENT_IN;
    capi_rho_tmp = array_from_pyobj(NPY_DOUBLE,rho_Dims,rho_Rank,capi_rho_intent,rho_capi);
    if (capi_rho_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 7th argument `rho' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        rho = (double *)(PyArray_DATA(capi_rho_tmp));

    /* Processing variable t */
    if (t_capi == Py_None) t = shape(forces, 1); else
        f2py_success = int_from_pyobj(&t,t_capi,"SCHAModules.anharmonic.get_df_dcoeff_av_new() 3rd keyword (t) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(forces, 1) == t,"shape(forces, 1) == t","3rd keyword t","get_df_dcoeff_av_new:t=%d",t) {
    /* Processing variable mass */
    mass_Dims[0]=t;
    capi_mass_intent |= F2PY_INTENT_IN;
    capi_mass_tmp = array_from_pyobj(NPY_DOUBLE,mass_Dims,mass_Rank,capi_mass_intent,mass_capi);
    if (capi_mass_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 5th argument `mass' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_tmp));

    /* Processing variable dedc */
    dedc_Dims[0]=3 * t,dedc_Dims[1]=s;
    capi_dedc_intent |= F2PY_INTENT_IN;
    capi_dedc_tmp = array_from_pyobj(NPY_DOUBLE,dedc_Dims,dedc_Rank,capi_dedc_intent,dedc_capi);
    if (capi_dedc_tmp == NULL) {
        PyObject *exc, *val, *tb;
        PyErr_Fetch(&exc, &val, &tb);
        PyErr_SetString(exc ? exc : SCHAModules_error,"failed in converting 6th argument `dedc' of SCHAModules.anharmonic.get_df_dcoeff_av_new to C/Fortran array" );
        npy_PyErr_ChainExceptionsCause(exc, val, tb);
    } else {
        dedc = (double *)(PyArray_DATA(capi_dedc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(df,da,forces,q,mass,dedc,rho,&minim_polvec,log_err,&dfdc,&delta_dfdc,&r,&s,&t,slen(log_err));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("dd",dfdc,delta_dfdc);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_dedc_tmp!=dedc_capi) {
        Py_XDECREF(capi_dedc_tmp); }
    }  /*if (capi_dedc_tmp == NULL) ... else of dedc*/
    /* End of cleaning variable dedc */
    if((PyObject *)capi_mass_tmp!=mass_capi) {
        Py_XDECREF(capi_mass_tmp); }
    }  /*if (capi_mass_tmp == NULL) ... else of mass*/
    /* End of cleaning variable mass */
    } /*CHECKSCALAR(shape(forces, 1) == t)*/
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_rho_tmp!=rho_capi) {
        Py_XDECREF(capi_rho_tmp); }
    }  /*if (capi_rho_tmp == NULL) ... else of rho*/
    /* End of cleaning variable rho */
    if((PyObject *)capi_forces_tmp!=forces_capi) {
        Py_XDECREF(capi_forces_tmp); }
    }  /*if (capi_forces_tmp == NULL) ... else of forces*/
    /* End of cleaning variable forces */
    if((PyObject *)capi_da_tmp!=da_capi) {
        Py_XDECREF(capi_da_tmp); }
    }  /*if (capi_da_tmp == NULL) ... else of da*/
    /* End of cleaning variable da */
    if((PyObject *)capi_q_tmp!=q_capi) {
        Py_XDECREF(capi_q_tmp); }
    }  /*if (capi_q_tmp == NULL) ... else of q*/
    /* End of cleaning variable q */
    } /*CHECKSCALAR(shape(df, 1) == s)*/
    } /*if (f2py_success) of s*/
    /* End of cleaning variable s */
    } /*CHECKSCALAR(shape(df, 0) == r)*/
    } /*if (f2py_success) of r*/
    /* End of cleaning variable r */
    /* End of cleaning variable delta_dfdc */
    /* End of cleaning variable dfdc */
        STRINGFREE(log_err);
    }  /*if (f2py_success) of log_err*/
    /* End of cleaning variable log_err */
    } /*if (f2py_success) of minim_polvec*/
    /* End of cleaning variable minim_polvec */
    if((PyObject *)capi_df_tmp!=df_capi) {
        Py_XDECREF(capi_df_tmp); }
    }  /*if (capi_df_tmp == NULL) ... else of df*/
    /* End of cleaning variable df */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of get_df_dcoeff_av_new ************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/

static FortranDataDef f2py_stochastic_def[] = {
  {"average_1d",0,{{-1}},NPY_FLOAT},
  {"average_3d",0,{{-1}},NPY_FLOAT},
  {"standard_deviation_1d",0,{{-1}},NPY_FLOAT},
  {"random_gaussian",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_random_gaussian,doc_f2py_rout_SCHAModules_stochastic_random_gaussian},
  {"check_gaussian",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_check_gaussian,doc_f2py_rout_SCHAModules_stochastic_check_gaussian},
  {"get_gaussian_weight",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_get_gaussian_weight,doc_f2py_rout_SCHAModules_stochastic_get_gaussian_weight},
  {"get_gaussian_weight_eff_charge",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_get_gaussian_weight_eff_charge,doc_f2py_rout_SCHAModules_stochastic_get_gaussian_weight_eff_charge},
  {"average_error_weight",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_average_error_weight,doc_f2py_rout_SCHAModules_stochastic_average_error_weight},
  {"random_sphere",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_stochastic_random_sphere,doc_f2py_rout_SCHAModules_stochastic_random_sphere},
  {NULL}
};

static void f2py_setup_stochastic(char *average_1d,char *average_3d,char *standard_deviation_1d,char *random_gaussian,char *check_gaussian,char *get_gaussian_weight,char *get_gaussian_weight_eff_charge,char *average_error_weight,char *random_sphere) {
  int i_f2py=0;
  f2py_stochastic_def[i_f2py++].data = average_1d;
  f2py_stochastic_def[i_f2py++].data = average_3d;
  f2py_stochastic_def[i_f2py++].data = standard_deviation_1d;
  f2py_stochastic_def[i_f2py++].data = random_gaussian;
  f2py_stochastic_def[i_f2py++].data = check_gaussian;
  f2py_stochastic_def[i_f2py++].data = get_gaussian_weight;
  f2py_stochastic_def[i_f2py++].data = get_gaussian_weight_eff_charge;
  f2py_stochastic_def[i_f2py++].data = average_error_weight;
  f2py_stochastic_def[i_f2py++].data = random_sphere;
}
extern void F_FUNC(f2pyinitstochastic,F2PYINITSTOCHASTIC)(void (*)(char*,char*,char*,char *,char *,char *,char *,char *,char *));
static void f2py_init_stochastic(void) {
  F_FUNC(f2pyinitstochastic,F2PYINITSTOCHASTIC)(f2py_setup_stochastic);
}


static FortranDataDef f2py_thermodynamic_def[] = {
  {"w_to_a",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_thermodynamic_w_to_a,doc_f2py_rout_SCHAModules_thermodynamic_w_to_a},
  {"w_to_da",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_thermodynamic_w_to_da,doc_f2py_rout_SCHAModules_thermodynamic_w_to_da},
  {"dw_f0_u0",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_thermodynamic_dw_f0_u0,doc_f2py_rout_SCHAModules_thermodynamic_dw_f0_u0},
  {"nb",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_thermodynamic_nb,doc_f2py_rout_SCHAModules_thermodynamic_nb},
  {NULL}
};

static void f2py_setup_thermodynamic(char *w_to_a,char *w_to_da,char *dw_f0_u0,char *nb) {
  int i_f2py=0;
  f2py_thermodynamic_def[i_f2py++].data = w_to_a;
  f2py_thermodynamic_def[i_f2py++].data = w_to_da;
  f2py_thermodynamic_def[i_f2py++].data = dw_f0_u0;
  f2py_thermodynamic_def[i_f2py++].data = nb;
}
extern void F_FUNC(f2pyinitthermodynamic,F2PYINITTHERMODYNAMIC)(void (*)(char *,char *,char *,char *));
static void f2py_init_thermodynamic(void) {
  F_FUNC(f2pyinitthermodynamic,F2PYINITTHERMODYNAMIC)(f2py_setup_thermodynamic);
}


static FortranDataDef f2py_anharmonic_def[] = {
  {"get_df_da_nonav",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_anharmonic_get_df_da_nonav,doc_f2py_rout_SCHAModules_anharmonic_get_df_da_nonav},
  {"get_da_dcr_and_de_dcr",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_anharmonic_get_da_dcr_and_de_dcr,doc_f2py_rout_SCHAModules_anharmonic_get_da_dcr_and_de_dcr},
  {"get_df_dcoeff_av_new",-1,{{-1}},0,NULL,(void *)f2py_rout_SCHAModules_anharmonic_get_df_dcoeff_av_new,doc_f2py_rout_SCHAModules_anharmonic_get_df_dcoeff_av_new},
  {NULL}
};

static void f2py_setup_anharmonic(char *get_df_da_nonav,char *get_da_dcr_and_de_dcr,char *get_df_dcoeff_av_new) {
  int i_f2py=0;
  f2py_anharmonic_def[i_f2py++].data = get_df_da_nonav;
  f2py_anharmonic_def[i_f2py++].data = get_da_dcr_and_de_dcr;
  f2py_anharmonic_def[i_f2py++].data = get_df_dcoeff_av_new;
}
extern void F_FUNC(f2pyinitanharmonic,F2PYINITANHARMONIC)(void (*)(char *,char *,char *));
static void f2py_init_anharmonic(void) {
  F_FUNC(f2pyinitanharmonic,F2PYINITANHARMONIC)(f2py_setup_anharmonic);
}

/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {
    {"get_stress_tensor",-1,{{-1}},0,(char *)F_FUNC_US(get_stress_tensor,GET_STRESS_TENSOR),(f2py_init_func)f2py_rout_SCHAModules_get_stress_tensor,doc_f2py_rout_SCHAModules_get_stress_tensor},
    {"get_gradient_supercell",-1,{{-1}},0,(char *)F_FUNC_US(get_gradient_supercell,GET_GRADIENT_SUPERCELL),(f2py_init_func)f2py_rout_SCHAModules_get_gradient_supercell,doc_f2py_rout_SCHAModules_get_gradient_supercell},
    {"get_gradient_supercell_new",-1,{{-1}},0,(char *)F_FUNC_US(get_gradient_supercell_new,GET_GRADIENT_SUPERCELL_NEW),(f2py_init_func)f2py_rout_SCHAModules_get_gradient_supercell_new,doc_f2py_rout_SCHAModules_get_gradient_supercell_new},
    {"get_upsilon_matrix",-1,{{-1}},0,(char *)F_FUNC_US(get_upsilon_matrix,GET_UPSILON_MATRIX),(f2py_init_func)f2py_rout_SCHAModules_get_upsilon_matrix,doc_f2py_rout_SCHAModules_get_upsilon_matrix},
    {"get_fmunu",-1,{{-1}},0,(char *)F_FUNC_US(get_fmunu,GET_FMUNU),(f2py_init_func)f2py_rout_SCHAModules_get_fmunu,doc_f2py_rout_SCHAModules_get_fmunu},
    {"multiply_lambda_tensor",-1,{{-1}},0,(char *)F_FUNC_US(multiply_lambda_tensor,MULTIPLY_LAMBDA_TENSOR),(f2py_init_func)f2py_rout_SCHAModules_multiply_lambda_tensor,doc_f2py_rout_SCHAModules_multiply_lambda_tensor},
    {"cell_force",-1,{{-1}},0,(char *)F_FUNC_US(cell_force,CELL_FORCE),(f2py_init_func)f2py_rout_SCHAModules_cell_force,doc_f2py_rout_SCHAModules_cell_force},
    {"get_gradient_supercell_fast",-1,{{-1}},0,(char *)F_FUNC_US(get_gradient_supercell_fast,GET_GRADIENT_SUPERCELL_FAST),(f2py_init_func)f2py_rout_SCHAModules_get_gradient_supercell_fast,doc_f2py_rout_SCHAModules_get_gradient_supercell_fast},
    {"get_unpreconditioned_gradient",-1,{{-1}},0,(char *)F_FUNC_US(get_unpreconditioned_gradient,GET_UNPRECONDITIONED_GRADIENT),(f2py_init_func)f2py_rout_SCHAModules_get_unpreconditioned_gradient,doc_f2py_rout_SCHAModules_get_unpreconditioned_gradient},
    {"get_ymu",-1,{{-1}},0,(char *)F_FUNC_US(get_ymu,GET_YMU),(f2py_init_func)f2py_rout_SCHAModules_get_ymu,doc_f2py_rout_SCHAModules_get_ymu},
    {"get_g",-1,{{-1}},0,(char *)F_FUNC_US(get_g,GET_G),(f2py_init_func)f2py_rout_SCHAModules_get_g,doc_f2py_rout_SCHAModules_get_g},
    {"get_emat",-1,{{-1}},0,(char *)F_FUNC_US(get_emat,GET_EMAT),(f2py_init_func)f2py_rout_SCHAModules_get_emat,doc_f2py_rout_SCHAModules_get_emat},
    {"get_v3",-1,{{-1}},0,(char *)F_FUNC_US(get_v3,GET_V3),(f2py_init_func)f2py_rout_SCHAModules_get_v3,doc_f2py_rout_SCHAModules_get_v3},
    {"get_odd_straight",-1,{{-1}},0,(char *)F_FUNC_US(get_odd_straight,GET_ODD_STRAIGHT),(f2py_init_func)f2py_rout_SCHAModules_get_odd_straight,doc_f2py_rout_SCHAModules_get_odd_straight},
    {"get_cmat",-1,{{-1}},0,(char *)F_FUNC_US(get_cmat,GET_CMAT),(f2py_init_func)f2py_rout_SCHAModules_get_cmat,doc_f2py_rout_SCHAModules_get_cmat},
    {"get_v4",-1,{{-1}},0,(char *)F_FUNC_US(get_v4,GET_V4),(f2py_init_func)f2py_rout_SCHAModules_get_v4,doc_f2py_rout_SCHAModules_get_v4},
    {"get_odd_straight_with_v4",-1,{{-1}},0,(char *)F_FUNC_US(get_odd_straight_with_v4,GET_ODD_STRAIGHT_WITH_V4),(f2py_init_func)f2py_rout_SCHAModules_get_odd_straight_with_v4,doc_f2py_rout_SCHAModules_get_odd_straight_with_v4},

/*eof routine_defs*/
    {NULL}
};

static PyMethodDef f2py_module_methods[] = {

    {NULL,NULL}
};

static struct PyModuleDef moduledef = {
    PyModuleDef_HEAD_INIT,
    "SCHAModules",
    NULL,
    -1,
    f2py_module_methods,
    NULL,
    NULL,
    NULL,
    NULL
};

PyMODINIT_FUNC PyInit_SCHAModules(void) {
    int i;
    PyObject *m,*d, *s, *tmp;
    m = SCHAModules_module = PyModule_Create(&moduledef);
    Py_SET_TYPE(&PyFortran_Type, &PyType_Type);
    import_array();
    if (PyErr_Occurred())
        {PyErr_SetString(PyExc_ImportError, "can't initialize module SCHAModules (failed to import numpy)"); return m;}
    d = PyModule_GetDict(m);
    s = PyUnicode_FromString("1.23.3");
    PyDict_SetItemString(d, "__version__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString(
        "This module 'SCHAModules' is auto-generated with f2py (version:1.23.3).\nFunctions:\n"
"    stress_tensor,error_on_stress_tensor = get_stress_tensor(volume,forces_e,u_vector,abinit_stress_tensors,wr,er,t,rho,log_err,nrandom=shape(forces_e, 0),natoms_sc=shape(forces_e, 1),nmodes=shape(wr, 0))\n"
"    grad,grad_err = get_gradient_supercell(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,n_random=shape(rho, 0),natsc=shape(u_disp, 1),n_modes=shape(wr_sc, 0),ntyp_sc=shape(mass, 0),preconditioned=)\n"
"    grad,grad_err = get_gradient_supercell_new(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,n_random=shape(rho, 0),natsc=shape(u_disp, 1),n_modes=shape(wr_sc, 0),ntyp_sc=shape(mass, 0))\n"
"    ups = get_upsilon_matrix(wr,epols,trans,mass,ityp,t,nmodes=shape(wr, 0),nat=shape(epols, 0) / 3,ntyp=shape(mass, 0))\n"
"    f_munu = get_fmunu(w_mu,w_nu,t)\n"
"    output_matrix = multiply_lambda_tensor(wr,pols,trans,mass,ityp,t,input_matrix,inverse,nmodes=shape(wr, 0),nat=shape(pols, 0) / 3,ntyp=shape(mass, 0))\n"
"    fcell = cell_force(ainv,stress,omega,press,wmassin=)\n"
"    grad,grad_err = get_gradient_supercell_fast(rho,u_disp,eforces,wr_sc,epols_sc,trans,t,mass,ityp_sc,log_err,n_random=shape(rho, 0),natsc=shape(u_disp, 1),n_modes=shape(wr_sc, 0),ntyp_sc=shape(mass, 0),preconditioned=)\n"
"    gradient,err_gradient = get_unpreconditioned_gradient(u,f,e_pols,w,t,mass,ityp,rho,log_err,n=shape(u, 0),nrand=shape(u, 1),nmodes=shape(e_pols, 1),ntyp=shape(mass, 0))\n"
"    y_mu = get_ymu(w,t)\n"
"    g = get_g(a,wr,transmode,t,n_mode=shape(a, 0))\n"
"    e = get_emat(er,a,amass,ityp_sc,v3_log,transmode,n_mode=shape(er, 1),nat_sc=shape(er, 0),ntyp=shape(amass, 0))\n"
"    v3 = get_v3(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,nat_sc=shape(er, 0),n_mode=shape(a, 0),n_random=shape(f, 0),ntyp=shape(amass, 0))\n"
"    phi_sc_odd = get_odd_straight(a,wr,er,transmode,amass,ityp_sc,t,v3,n_mode=shape(a, 0),nat_sc=shape(er, 0),ntyp=shape(amass, 0))\n"
"    cmat = get_cmat(a,wr,er,transmode,amass,ityp_sc,t,v3_log,n_mode=shape(a, 0),nat_sc=shape(er, 0),ntyp=shape(amass, 0))\n"
"    v4 = get_v4(a,er,transmode,amass,ityp_sc,f,u,rho,log_err,nat_sc=shape(er, 0),n_mode=shape(a, 0),n_random=shape(f, 0),ntyp=shape(amass, 0))\n"
"    phi_sc_odd = get_odd_straight_with_v4(a,wr,er,transmode,amass,ityp_sc,t,v3,v4,n_mode=shape(a, 0),nat_sc=shape(er, 0),ntyp=shape(amass, 0))\n"
"Fortran 90/95 modules:\n""  stochastic --- average_1d,average_3d,standard_deviation_1d,random_gaussian(),check_gaussian(),get_gaussian_weight(),get_gaussian_weight_eff_charge(),average_error_weight(),random_sphere()""  thermodynamic --- w_to_a(),w_to_da(),dw_f0_u0(),nb()""  anharmonic --- get_df_da_nonav(),get_da_dcr_and_de_dcr(),get_df_dcoeff_av_new()"".");
    PyDict_SetItemString(d, "__doc__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString("1.23.3");
    PyDict_SetItemString(d, "__f2py_numpy_version__", s);
    Py_DECREF(s);
    SCHAModules_error = PyErr_NewException ("SCHAModules.error", NULL, NULL);
    /*
     * Store the error object inside the dict, so that it could get deallocated.
     * (in practice, this is a module, so it likely will not and cannot.)
     */
    PyDict_SetItemString(d, "_SCHAModules_error", SCHAModules_error);
    Py_DECREF(SCHAModules_error);
    for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
        tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
        PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
        Py_DECREF(tmp);
    }






























/*eof initf2pywraphooks*/
  PyDict_SetItemString(d, "anharmonic", PyFortranObject_New(f2py_anharmonic_def,f2py_init_anharmonic));
  PyDict_SetItemString(d, "thermodynamic", PyFortranObject_New(f2py_thermodynamic_def,f2py_init_thermodynamic));
  PyDict_SetItemString(d, "stochastic", PyFortranObject_New(f2py_stochastic_def,f2py_init_stochastic));
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
    if (! PyErr_Occurred())
        on_exit(f2py_report_on_exit,(void*)"SCHAModules");
#endif
    return m;
}
#ifdef __cplusplus
}
#endif
